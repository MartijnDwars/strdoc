<code id="0"><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1"></span><span style="color: rgb(63, 127, 95)"> * This module contains strategies for operating on strings.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="2"></span><span style="color: rgb(63, 127, 95)"> *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="3"></span><span style="color: rgb(63, 127, 95)"> * In Stratego, strings are primitive terms, separate from characters</span><span style="color: rgb(63, 127, 95)"></code>
<code id="4"></span><span style="color: rgb(63, 127, 95)"> * and character lists. It is recommended that all strings contain only</span><span style="color: rgb(63, 127, 95)"></code>
<code id="5"></span><span style="color: rgb(63, 127, 95)"> * ISO-8859-1 (Latin1) characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="6"></span><span style="color: rgb(63, 127, 95)"> * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="7"></span><span style="color: rgb(63, 127, 95)"> * @author Eelco Visser &lt;visser@acm.org&gt;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="8"></span><span style="color: rgb(63, 127, 95)"> * @author Karl Trygve Kalleberg &lt;karltk@strategoxt.org&gt;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="9"></span><span style="color: rgb(63, 127, 95)"> * @author Lennart Kats &lt;lennart add lclnet.nl&gt;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="10"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="11"></span><span style="color: rgb(127, 0, 85)">module</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">term/string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="12"></span><span style="color: rgb(127, 0, 85)">imports</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="13"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list/common</span><span style="color: rgb(63, 127, 95)"></code>
<code id="14"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">strategy/conditional</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="15"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">strategy/iteration</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="16"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">system/io/file</span><span style="color: rgb(63, 127, 95)"></code>
<code id="17"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="18"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="19"></span><span style="color: rgb(63, 127, 95)"> * Primitives</span><span style="color: rgb(63, 127, 95)"></code>
<code id="20"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="21"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="22"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="23"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="24"></span><span style="color: rgb(63, 127, 95)">   * Generates a unique new string of the form 'c_d',</span><span style="color: rgb(63, 127, 95)"></code>
<code id="25"></span><span style="color: rgb(63, 127, 95)">   * where c is one char and d is a positive integer.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="26"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="27"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">new</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_new&quot;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="28"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="29"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="30"></span><span style="color: rgb(63, 127, 95)">   * Generates a unique new string with user-defined prefix</span><span style="color: rgb(63, 127, 95)"></code>
<code id="31"></span><span style="color: rgb(63, 127, 95)">   * the form 'sd', where s is a string and d is a positive integer.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="32"></span><span style="color: rgb(63, 127, 95)">   * The produced string is *always* unique across a program run.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="33"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="34"></span><span style="color: rgb(63, 127, 95)">   * The prefix comes in front of an increasing number, which is</span><span style="color: rgb(63, 127, 95)"></code>
<code id="35"></span><span style="color: rgb(63, 127, 95)">   * separately maintained and started at 0 for each prefix.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="36"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="37"></span><span style="color: rgb(63, 127, 95)">   * Examples (results are shown in comment)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="38"></span><span style="color: rgb(63, 127, 95)">   *     &lt;newname; debug&gt; &quot;a&quot;        // produces &quot;a0&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="39"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;a&quot;        // produces &quot;a1&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="40"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;a&quot;        // produces &quot;a2&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="41"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;b&quot;        // produces &quot;b0&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="42"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;b&quot;        // produces &quot;b1&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="43"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;b_2&quot;      // produces &quot;b_20&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="44"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;b_2&quot;      // produces &quot;b_21&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="45"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;b_a&quot;      // produces &quot;b_a0&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="46"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;b_a&quot;      // produces &quot;b_a1&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="47"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;a_&quot;       // produces &quot;a_0&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="48"></span><span style="color: rgb(63, 127, 95)">   *   ; &lt;newname; debug&gt; &quot;a_1&quot;      // produces &quot;a_10&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="49"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="50"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">newname</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">prefix</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_newname&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">prefix</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="51"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="52"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="53"></span><span style="color: rgb(63, 127, 95)">   * Generates a unique new term.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="54"></span><span style="color: rgb(63, 127, 95)">   * May not necessarily be a string, depending on the platform.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="55"></span><span style="color: rgb(63, 127, 95)">   * May be slightly more efficient than a standard 'new.'</span><span style="color: rgb(63, 127, 95)"></code>
<code id="56"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="57"></span><span style="color: rgb(63, 127, 95)">   * @since 0.18</span><span style="color: rgb(63, 127, 95)"></code>
<code id="58"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="59"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">newterm</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="60"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">if-c-platform</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_new&quot;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="61"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">if-java-platform</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">SRTS-EXT-newint</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="62"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="63"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">external</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">SRTS-EXT-newint</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="64"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="65"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="66"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks if the supplied term is a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="67"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="68"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="69"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="70"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-string</span><span style="color: rgb(0, 64, 128)">	 </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_is_string&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="71"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="72"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="73"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks if the supplied term is a printable character.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="74"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="75"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="76"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="77"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-char</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">is-int</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">is-ascii</span><span style="color: rgb(63, 127, 95)"></code>
<code id="78"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="79"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="80"></span><span style="color: rgb(63, 127, 95)">   * Implodes a list of chars to a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="81"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="82"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="83"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="84"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_implode_string&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="85"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="86"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="87"></span><span style="color: rgb(63, 127, 95)">   * Explodes a String to a list of chars.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="88"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="89"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="90"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="91"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_explode_string&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(63, 127, 95)"></code>
<code id="92"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="93"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="94"></span><span style="color: rgb(63, 127, 95)">   * Wraps a strategy on a list of chars in a strategy on a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="95"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="96"></span><span style="color: rgb(63, 127, 95)">   * @param List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="97"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="98"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="99"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="100"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="101"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"></code>
<code id="102"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="103"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="104"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="105"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="106"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="107"></span><span style="color: rgb(63, 127, 95)">   * Concats a tuple of two Strings.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="108"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="109"></span><span style="color: rgb(63, 127, 95)">   * @type String * String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="110"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="111"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">conc-strings</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="112"></span><span style="color: rgb(0, 64, 128)">     </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">strcat</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="113"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="114"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="115"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="116"></span><span style="color: rgb(63, 127, 95)">   * Concats a tuple of two Strings.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="117"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="118"></span><span style="color: rgb(63, 127, 95)">   * @warning  doesn't accept tuples with more than two string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="119"></span><span style="color: rgb(63, 127, 95)">   * @type     String * String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="120"></span><span style="color: rgb(63, 127, 95)">   * @inc      strcat-1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="121"></span><span style="color: rgb(63, 127, 95)">   * @inc      strcat-2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="122"></span><span style="color: rgb(63, 127, 95)">   * @inc      strcat-3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="123"></span><span style="color: rgb(63, 127, 95)">   * @inc      strcat-4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="124"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="125"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">strcat</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="126"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">str1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">str2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_strcat&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">str1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">str2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="127"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="128"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="129"></span><span style="color: rgb(63, 127, 95)">   * Concats a list of Strings</span><span style="color: rgb(63, 127, 95)"></code>
<code id="130"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="131"></span><span style="color: rgb(63, 127, 95)">   * @type List(String) -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="132"></span><span style="color: rgb(63, 127, 95)">   * @inc      concat-strings-1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="133"></span><span style="color: rgb(63, 127, 95)">   * @inc      concat-strings-2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="134"></span><span style="color: rgb(63, 127, 95)">   * @inc      concat-strings-3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="135"></span><span style="color: rgb(63, 127, 95)">   * @inc      concat-strings-4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="136"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="137"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="138"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">strings</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_concat_strings&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">strings</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="139"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="140"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="141"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="142"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="143"></span><span style="color: rgb(63, 127, 95)">   * Returns the number of characters in a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="144"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="145"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="146"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="147"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-length</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="148"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">strlen</span><span style="color: rgb(63, 127, 95)"></code>
<code id="149"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="150"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="151"></span><span style="color: rgb(63, 127, 95)">   * Returns the number of characters in a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="152"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="153"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="154"></span><span style="color: rgb(63, 127, 95)">   * @inc      strlen-1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="155"></span><span style="color: rgb(63, 127, 95)">   * @inc      strlen-2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="156"></span><span style="color: rgb(63, 127, 95)">   * @inc      strlen-3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="157"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="158"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">strlen</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="159"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">str</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_strlen&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">str</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="160"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="161"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="162"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="163"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="164"></span><span style="color: rgb(63, 127, 95)">   * Escapes double quotes, backslash and linefeed to C like escape sequences.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="165"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="166"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="167"></span><span style="color: rgb(63, 127, 95)">   * @inc  escape-test1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="168"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="169"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">escape</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">escape-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="170"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="171"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="172"></span><span style="color: rgb(63, 127, 95)">   * Escapes double quotes, backslash and linefeed to C like escape sequences.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="173"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="174"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="175"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="176"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">escape-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="177"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">escape-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Escape</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="178"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="179"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="180"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">escape-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="181"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="182"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="183"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="184"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="185"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="186"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="187"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="188"></span><span style="color: rgb(63, 127, 95)">   * Unescapes double quotes, backslash, linefeed and tabs.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="189"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="190"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="191"></span><span style="color: rgb(63, 127, 95)">   * @inc unescape-test1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="192"></span><span style="color: rgb(63, 127, 95)">   * @inc unescape-test2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="193"></span><span style="color: rgb(63, 127, 95)">   * @inc unescape-test3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="194"></span><span style="color: rgb(63, 127, 95)">   * @inc unescape-test4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="195"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="196"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unescape</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">unescape-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="197"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="198"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="199"></span><span style="color: rgb(63, 127, 95)">   * Unescapes characters using a specified unescape strategy.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="200"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="201"></span><span style="color: rgb(63, 127, 95)">   * @param List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="202"></span><span style="color: rgb(63, 127, 95)">   * @type  List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="203"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="204"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unescape-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="205"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="206"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="207"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="208"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="209"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="210"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="211"></span><span style="color: rgb(63, 127, 95)">   * Unescapes double quotes, backslash, linefeed and tabs.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="212"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="213"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="214"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="215"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unescape-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="216"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">unescape-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">UnEscape</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="217"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="218"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="219"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="220"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="221"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Escape</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="222"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">Escape-double-quote</span><span style="color: rgb(63, 127, 95)"></code>
<code id="223"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Escape-backslash</span><span style="color: rgb(63, 127, 95)"></code>
<code id="224"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Escape-linefeed</span><span style="color: rgb(63, 127, 95)"></code>
<code id="225"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Escape-carriage-return</span><span style="color: rgb(63, 127, 95)"></code>
<code id="226"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="227"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="228"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Escape-double-quote</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="229"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="230"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="231"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Escape-single-quote</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="232"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="233"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="234"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Escape-backslash</span><span style="color: rgb(0, 64, 128)">       </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="235"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="236"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="237"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Escape-linefeed</span><span style="color: rgb(0, 64, 128)">        </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\n'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'n'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="238"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="239"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="240"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Escape-carriage-return</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\r'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'r'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="241"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="242"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="243"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="244"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="245"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="246"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">UnEscape-double-quote</span><span style="color: rgb(63, 127, 95)"></code>
<code id="247"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UnEscape-backslash</span><span style="color: rgb(63, 127, 95)"></code>
<code id="248"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UnEscape-linefeed</span><span style="color: rgb(63, 127, 95)"></code>
<code id="249"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UnEscape-tab</span><span style="color: rgb(63, 127, 95)"></code>
<code id="250"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UnEscape-carriage-return</span><span style="color: rgb(63, 127, 95)"></code>
<code id="251"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="252"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="253"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape-double-quote</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="254"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="255"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="256"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape-single-quote</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="257"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="258"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="259"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape-backslash</span><span style="color: rgb(0, 64, 128)">       </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="260"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="261"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="262"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape-carriage-return</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'r'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\r'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="263"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="264"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="265"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape-linefeed</span><span style="color: rgb(0, 64, 128)">        </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'n'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\n'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="266"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="267"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="268"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape-tab</span><span style="color: rgb(0, 64, 128)">             </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'t'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\t'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="269"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="270"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="271"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnEscape</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="272"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="273"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="274"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="275"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="276"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="277"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">escape</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">esc</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">List</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">String</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">List</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">String</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">List</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">String</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">List</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">String</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="278"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="279"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">esc</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="280"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="281"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="282"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="283"></span><span style="color: rgb(63, 127, 95)">   * @inc escape-test2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="284"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="285"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">cify</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">escape</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Cify</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="286"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="287"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="288"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">uncify</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">escape</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">UnCify</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="289"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="290"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="291"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnCify</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">UnCify1</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UnCify2</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UnCify3</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="292"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="293"></span><span style="color: rgb(127, 0, 85)">rules</span><span style="color: rgb(63, 127, 95)"></code>
<code id="294"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="295"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="296"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Cify</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'p'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="297"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="298"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="299"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Cify</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'-'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)">           </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="300"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="301"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="302"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Cify</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="303"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="304"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="305"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Cify</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'q'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="306"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="307"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="308"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Cify</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'b'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="309"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="310"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="311"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnCify1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'b'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="312"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="313"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="314"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnCify1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'q'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="315"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="316"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="317"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnCify1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'p'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="318"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="319"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="320"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnCify2</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="321"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="322"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="323"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UnCify3</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'_'</span><span style="color: rgb(63, 127, 95)">           </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'-'</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="324"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="325"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="326"></span><span style="color: rgb(63, 127, 95)"> * Quoting Literals</span><span style="color: rgb(63, 127, 95)"></code>
<code id="327"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="328"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="329"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="330"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="331"></span><span style="color: rgb(63, 127, 95)">   * param  () -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="332"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="333"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="334"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">quote</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">quote-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">c</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="335"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="336"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="337"></span><span style="color: rgb(63, 127, 95)">   * param  () -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="338"></span><span style="color: rgb(63, 127, 95)">   * @type  List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="339"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="340"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">quote-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">quote-chars</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">c</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="341"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="342"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="343"></span><span style="color: rgb(63, 127, 95)">   * @type Char * List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="344"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="345"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">quote-chars</span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="346"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">chars</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="347"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="348"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="349"></span><span style="color: rgb(63, 127, 95)">   * Adds single quotes to the start and end of a list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="350"></span><span style="color: rgb(63, 127, 95)">   * of characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="351"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="352"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="353"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="354"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">single-quote-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">quote-chars</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="355"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="356"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="357"></span><span style="color: rgb(63, 127, 95)">   * Adds double quotes to the start and end of a </span><span style="color: rgb(63, 127, 95)"></code>
<code id="358"></span><span style="color: rgb(63, 127, 95)">   * list of characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="359"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="360"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="361"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="362"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">double-quote-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">quote-chars</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="363"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="364"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="365"></span><span style="color: rgb(63, 127, 95)">   * @inc single-quote-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="366"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="367"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">single-quote</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">single-quote-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="368"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="369"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="370"></span><span style="color: rgb(63, 127, 95)">   * Adds double quotes to the start and end of </span><span style="color: rgb(63, 127, 95)"></code>
<code id="371"></span><span style="color: rgb(63, 127, 95)">   * a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="372"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="373"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="374"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="375"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">double-quote</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">double-quote-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="376"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="377"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="378"></span><span style="color: rgb(63, 127, 95)"> * Unquoting</span><span style="color: rgb(63, 127, 95)"></code>
<code id="379"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="380"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="381"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="382"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="383"></span><span style="color: rgb(63, 127, 95)">   * Removes the first and last character of a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="384"></span><span style="color: rgb(63, 127, 95)">   * The characters must satisfy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="385"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="386"></span><span style="color: rgb(63, 127, 95)">   * @param Char -&gt;? _ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="387"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="388"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="389"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unquote</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="390"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="391"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="392"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="393"></span><span style="color: rgb(63, 127, 95)">   * Removes the first and last character of a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="394"></span><span style="color: rgb(63, 127, 95)">   * The first character must satisfy s1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="395"></span><span style="color: rgb(63, 127, 95)">   * The last character must satisfy s2.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="396"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="397"></span><span style="color: rgb(63, 127, 95)">   * @param  Char -&gt;? _ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="398"></span><span style="color: rgb(63, 127, 95)">   * @param  Char -&gt;? _ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="399"></span><span style="color: rgb(63, 127, 95)">   * @type   String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="400"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="401"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unquote</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="402"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="403"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="404"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="405"></span><span style="color: rgb(63, 127, 95)">   * Removes the first and last character of a list of characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="406"></span><span style="color: rgb(63, 127, 95)">   * The characters must satisfy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="407"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="408"></span><span style="color: rgb(63, 127, 95)">   * @param  Char -&gt;? _ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="409"></span><span style="color: rgb(63, 127, 95)">   * @type   List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="410"></span><span style="color: rgb(63, 127, 95)">   */  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="411"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="412"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="413"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="414"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="415"></span><span style="color: rgb(63, 127, 95)">   * Removes the first and last character of a list of characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="416"></span><span style="color: rgb(63, 127, 95)">   * The first character must satisfy s1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="417"></span><span style="color: rgb(63, 127, 95)">   * The last character must satisfy s2.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="418"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="419"></span><span style="color: rgb(63, 127, 95)">   * @param  Char -&gt;? _ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="420"></span><span style="color: rgb(63, 127, 95)">   * @param  Char -&gt;? _ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="421"></span><span style="color: rgb(63, 127, 95)">   * @type   List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="422"></span><span style="color: rgb(63, 127, 95)">   */  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="423"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="424"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="425"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">last</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="426"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(63, 127, 95)"></code>
<code id="427"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">init</span><span style="color: rgb(63, 127, 95)"></code>
<code id="428"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="429"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="430"></span><span style="color: rgb(63, 127, 95)">   * Removes single quotes from the start and end of a list </span><span style="color: rgb(63, 127, 95)"></code>
<code id="431"></span><span style="color: rgb(63, 127, 95)">   * of characters. Fails if the list is not properly</span><span style="color: rgb(63, 127, 95)"></code>
<code id="432"></span><span style="color: rgb(63, 127, 95)">   * quoted.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="433"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="434"></span><span style="color: rgb(63, 127, 95)">   * @type  List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="435"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="436"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">un-single-quote-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="437"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="438"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="439"></span><span style="color: rgb(63, 127, 95)">   * Removes double quotes from the start and end of a list </span><span style="color: rgb(63, 127, 95)"></code>
<code id="440"></span><span style="color: rgb(63, 127, 95)">   * of characters. Fails if the list is not properly</span><span style="color: rgb(63, 127, 95)"></code>
<code id="441"></span><span style="color: rgb(63, 127, 95)">   * quoted.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="442"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="443"></span><span style="color: rgb(63, 127, 95)">   * @type  List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="444"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="445"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">un-double-quote-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">unquote-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="446"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="447"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="448"></span><span style="color: rgb(63, 127, 95)">   * Removes single quotes from the start and end of a string </span><span style="color: rgb(63, 127, 95)"></code>
<code id="449"></span><span style="color: rgb(63, 127, 95)">   * Fails if the string is not properly quoted.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="450"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="451"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="452"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="453"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">un-single-quote</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">un-single-quote-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="454"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="455"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="456"></span><span style="color: rgb(63, 127, 95)">   * Removes double quotes from the start and end of a string </span><span style="color: rgb(63, 127, 95)"></code>
<code id="457"></span><span style="color: rgb(63, 127, 95)">   * Fails if the string is not properly quoted.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="458"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="459"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="460"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="461"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">un-double-quote</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">un-double-quote-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="462"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="463"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="464"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="465"></span><span style="color: rgb(63, 127, 95)"> /** Predicate that checks if a string is double quoted, i.e. quoted</span><span style="color: rgb(63, 127, 95)"></code>
<code id="466"></span><span style="color: rgb(63, 127, 95)">  * with double quotation marks (&quot;).</span><span style="color: rgb(63, 127, 95)"></code>
<code id="467"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="468"></span><span style="color: rgb(63, 127, 95)">  * @inc is-double-quote 1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="469"></span><span style="color: rgb(63, 127, 95)">  * @inc is-double-quote 2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="470"></span><span style="color: rgb(63, 127, 95)">  * @inc is-double-quote 3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="471"></span><span style="color: rgb(63, 127, 95)">  * @inc is-double-quote 4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="472"></span><span style="color: rgb(63, 127, 95)">  * @inc is-double-quote 5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="473"></span><span style="color: rgb(63, 127, 95)">  * @inc is-double-quote 6</span><span style="color: rgb(63, 127, 95)"></code>
<code id="474"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="475"></span><span style="color: rgb(63, 127, 95)">  * @type   String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="476"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="477"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-double-quoted</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="478"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-quoted</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="479"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="480"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="481"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks a string is quoted with single quotes.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="482"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="483"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="484"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="485"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-single-quoted</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="486"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-quoted</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="487"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="488"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="489"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks if a character list is double quoted. That</span><span style="color: rgb(63, 127, 95)"></code>
<code id="490"></span><span style="color: rgb(63, 127, 95)">   * is, if the first and last character are both double quotes.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="491"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="492"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="493"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="494"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-double-quoted-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="495"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-quoted-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">'&quot;'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="496"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="497"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="498"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks if a character list is single quoted. That is,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="499"></span><span style="color: rgb(63, 127, 95)">   * if the first and last character are both single quotes.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="500"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="501"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="502"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="503"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-single-quoted-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="504"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-quoted-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">'\''</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="505"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="506"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="507"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks if a string is quoted with the given character.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="508"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="509"></span><span style="color: rgb(63, 127, 95)">   * The character c is the quotation character to check for.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="510"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="511"></span><span style="color: rgb(63, 127, 95)">   * @param Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="512"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="513"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="514"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-quoted</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="515"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="516"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="517"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">is-quoted-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="518"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="519"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="520"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="521"></span><span style="color: rgb(63, 127, 95)">   * Predicate that checks if a list of characters is quoted with</span><span style="color: rgb(63, 127, 95)"></code>
<code id="522"></span><span style="color: rgb(63, 127, 95)">   * the character given by the term argument. That is, if the</span><span style="color: rgb(63, 127, 95)"></code>
<code id="523"></span><span style="color: rgb(63, 127, 95)">   * first and last character of the list are both equal to c.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="524"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="525"></span><span style="color: rgb(63, 127, 95)">   * @param Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="526"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="527"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="528"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-quoted-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="529"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">last</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="530"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="531"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="532"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="533"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="534"></span><span style="color: rgb(63, 127, 95)">   * @obsolete use string-to-int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="535"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="536"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-to-num</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="537"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">obsolete</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 255)">&quot;string-to-num; use string-to-int&quot;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="538"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">string-to-int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="539"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="540"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="541"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="542"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="543"></span><span style="color: rgb(63, 127, 95)">  * Converts all characters of this string to lower case</span><span style="color: rgb(63, 127, 95)"></code>
<code id="544"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="545"></span><span style="color: rgb(63, 127, 95)">  * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="546"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="547"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">lower-case</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">lower-case-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="548"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="549"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="550"></span><span style="color: rgb(63, 127, 95)">  * Converts all characters of this string to upper case</span><span style="color: rgb(63, 127, 95)"></code>
<code id="551"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="552"></span><span style="color: rgb(63, 127, 95)">  * @inc upper-case-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="553"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="554"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">upper-case</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">upper-case-chars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="555"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="556"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="557"></span><span style="color: rgb(63, 127, 95)">   * Converts a list of characters to lower case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="558"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="559"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;explode-string ; lower-case-char ; implode-string&gt; &quot;STRATEGO&quot; =&gt; &quot;stratego&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="560"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="561"></span><span style="color: rgb(63, 127, 95)">   * @type  List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="562"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="563"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">lower-case-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">to-lower</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="564"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="565"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="566"></span><span style="color: rgb(63, 127, 95)">   * Converts a list of characters to upper case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="567"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="568"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;explode-string ; upper-case-chars ; implode-string&gt; &quot;stratego&quot; =&gt; &quot;STRATEGO&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="569"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="570"></span><span style="color: rgb(63, 127, 95)">   * @type  List(Char) -&gt; List(Char)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="571"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="572"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">upper-case-chars</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">to-upper</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="573"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="574"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="575"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="576"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="577"></span><span style="color: rgb(63, 127, 95)">   * Breaks a string into tokens.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="578"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="579"></span><span style="color: rgb(63, 127, 95)">   * Given a list of possible delimiters (characters that</span><span style="color: rgb(63, 127, 95)"></code>
<code id="580"></span><span style="color: rgb(63, 127, 95)">   * separate tokens), string-tokenize returns a list of</span><span style="color: rgb(63, 127, 95)"></code>
<code id="581"></span><span style="color: rgb(63, 127, 95)">   * tokens for a given string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="582"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="583"></span><span style="color: rgb(63, 127, 95)">   * @param List of separate characters</span><span style="color: rgb(63, 127, 95)"></code>
<code id="584"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; List(String)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="585"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="586"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-tokenize</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">sepchars</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="587"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">string-tokenize</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sepchars</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="588"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="589"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="590"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-tokenize</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="591"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="592"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">list-tokenize</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">sep</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="593"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="594"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="595"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="596"></span><span style="color: rgb(63, 127, 95)">   * @inc   tokenize-test1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="597"></span><span style="color: rgb(63, 127, 95)">   * @inc   tokenize-test2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="598"></span><span style="color: rgb(63, 127, 95)">   * @inc   tokenize-test3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="599"></span><span style="color: rgb(63, 127, 95)">   * @inc   tokenize-test4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="600"></span><span style="color: rgb(63, 127, 95)">   * @inc   tokenize-test5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="601"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="602"></span><span style="color: rgb(63, 127, 95)">   * @type  (List(Char), String) -&gt; List(String)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="603"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="604"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-tokenize</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="605"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">sepchars</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="606"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">string-tokenize</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">sepchars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="607"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="608"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="609"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="610"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="611"></span><span style="color: rgb(63, 127, 95)">  * @param s  () -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="612"></span><span style="color: rgb(63, 127, 95)">  * @type String * Int -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="613"></span><span style="color: rgb(63, 127, 95)">  * @inc  padd-with-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="614"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="615"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">padd-with</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="616"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">align-right</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Fst</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Snd</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="617"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="618"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="619"></span><span style="color: rgb(63, 127, 95)">   * Remove padding from a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="620"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="621"></span><span style="color: rgb(63, 127, 95)">   * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="622"></span><span style="color: rgb(63, 127, 95)">   * @since 0.18</span><span style="color: rgb(63, 127, 95)"></code>
<code id="623"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="624"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="625"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="626"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 64, 128)">split-at-newlines</span><span style="color: rgb(63, 127, 95)"></code>
<code id="627"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">padding</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:=</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">length</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="628"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">padding</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">padding</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="629"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">at-last</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">rtrim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">' '</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'\t'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="630"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\n'</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="631"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">concat</span><span style="color: rgb(63, 127, 95)"></code>
<code id="632"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="633"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="634"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(127, 0, 85)">internal</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">max</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="635"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="636"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">max</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">max</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="637"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="638"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">' '</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="639"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">max</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">dec</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="640"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="641"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\t'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="642"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">max</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">4</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="643"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="644"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">max'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:=</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">max</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="645"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove-padding</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">max'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">max'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="646"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="647"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="648"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="649"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="650"></span><span style="color: rgb(63, 127, 95)">   * @type Char * String * Int -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="651"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="652"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">align-right</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="653"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc-strings</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">add</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="654"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">align-helper</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">add</span><span style="color: rgb(63, 127, 95)"></code>
<code id="655"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="656"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="657"></span><span style="color: rgb(63, 127, 95)">   * @type Char * String * Int -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="658"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="659"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">align-left</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="660"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc-strings</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">add</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="661"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">align-helper</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">add</span><span style="color: rgb(63, 127, 95)"></code>
<code id="662"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="663"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="664"></span><span style="color: rgb(63, 127, 95)">   * @type Char * String * Int -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="665"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="666"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">align-center</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="667"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">add-before</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">add-after</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="668"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">string-length</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(63, 127, 95)"></code>
<code id="669"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">whitespace</span><span style="color: rgb(63, 127, 95)"></code>
<code id="670"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 64, 128)">even</span><span style="color: rgb(63, 127, 95)"></code>
<code id="671"></span><span style="color: rgb(63, 127, 95)">              </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">div2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Dupl</span><span style="color: rgb(63, 127, 95)"></code>
<code id="672"></span><span style="color: rgb(63, 127, 95)">              </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">dec</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">div2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Dupl</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">inc</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="673"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">whitespace</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">before</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">after</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="674"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">align-helper</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">add</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">before</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">add-before</span><span style="color: rgb(63, 127, 95)"></code>
<code id="675"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">align-helper</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">add</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">after</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">add-after</span><span style="color: rgb(63, 127, 95)"></code>
<code id="676"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="677"></span><span style="color: rgb(63, 127, 95)">      /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="678"></span><span style="color: rgb(63, 127, 95)">       * @param c  Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="679"></span><span style="color: rgb(63, 127, 95)">       * @param n  Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="680"></span><span style="color: rgb(63, 127, 95)">       * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="681"></span><span style="color: rgb(63, 127, 95)">       */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="682"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 64, 128)">align-helper</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="683"></span><span style="color: rgb(0, 64, 128)">        </span><span style="color: rgb(0, 64, 128)">string-length</span><span style="color: rgb(63, 127, 95)"></code>
<code id="684"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="685"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">pos</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="686"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">copy-char</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="687"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"></code>
<code id="688"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="689"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="690"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="691"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 64, 128)">div2</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">div</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="692"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="693"></span><span style="color: rgb(127, 0, 85)">rules</span><span style="color: rgb(63, 127, 95)"></code>
<code id="694"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="695"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="696"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">SplitInit</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="697"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="698"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="699"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">SplitExit</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="700"></span><span style="color: rgb(0, 64, 128)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="701"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="702"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="703"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="704"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">SplitNext</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="705"></span><span style="color: rgb(0, 64, 128)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 128, 0)">32</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="706"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="707"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="708"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="709"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">SplitNext</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="710"></span><span style="color: rgb(0, 64, 128)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="711"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">32</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="712"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="713"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="714"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="715"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="716"></span><span style="color: rgb(63, 127, 95)">   * Splits a string at each occurrence of a whitespace. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="717"></span><span style="color: rgb(63, 127, 95)">   * resulting list of string does not contain any of the</span><span style="color: rgb(63, 127, 95)"></code>
<code id="718"></span><span style="color: rgb(63, 127, 95)">   * whitespaces. Two adjacent whitespaces will result in</span><span style="color: rgb(63, 127, 95)"></code>
<code id="719"></span><span style="color: rgb(63, 127, 95)">   * an empty string in the result.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="720"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="721"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;split-at-space&gt; &quot;foo  bar&quot; =&gt; [&quot;foo&quot;, &quot;&quot;, &quot;bar&quot;]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="722"></span><span style="color: rgb(63, 127, 95)">   *  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="723"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; List(String)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="724"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="725"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-at-space</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="726"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="727"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">SplitInit</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="728"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">SplitExit</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">SplitNext</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="729"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="730"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="731"></span><span style="color: rgb(63, 127, 95)">  * @inc split-at-dot-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="732"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="733"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-at-dot</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="734"></span><span style="color: rgb(0, 64, 128)">	  </span><span style="color: rgb(0, 64, 128)">split</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="735"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">int</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 128, 0)">46</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">frac</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">int</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">frac</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="736"></span><span style="color: rgb(63, 127, 95)">		</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">int</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">rest</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">at-end</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">int</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">rest</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="737"></span><span style="color: rgb(63, 127, 95)">		</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">Nil</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="738"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="739"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="740"></span><span style="color: rgb(63, 127, 95)">  // fails if sub isn't in l</span><span style="color: rgb(63, 127, 95)"></code>
<code id="741"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="742"></span><span style="color: rgb(63, 127, 95)">  * @inc split-before-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="743"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="744"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-before</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="745"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sub'</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="746"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="747"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="748"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">@</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">left-match</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">sub'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="749"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">at-end</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="750"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="751"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="752"></span><span style="color: rgb(63, 127, 95)">  // results in (l,&quot;&quot;) if sub isn't in l</span><span style="color: rgb(63, 127, 95)"></code>
<code id="753"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="754"></span><span style="color: rgb(63, 127, 95)">  * @inc split-after-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="755"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="756"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-after</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="757"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sub'</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="758"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="759"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="760"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="761"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">sub'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">left-match</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">sub'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="762"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">at-end</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">x'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="763"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="764"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="765"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="766"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="767"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the string produced by s is a substring</span><span style="color: rgb(63, 127, 95)"></code>
<code id="768"></span><span style="color: rgb(63, 127, 95)">   * of the argument string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="769"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="770"></span><span style="color: rgb(63, 127, 95)">   * @param _ -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="771"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="772"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="773"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-substring</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="774"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">long</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="775"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="776"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="777"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">long</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="778"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="779"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="780"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">@</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">left-match</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">sub</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="781"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">long</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="782"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="783"></span><span style="color: rgb(63, 127, 95)">  // &lt;copy-char&gt; (3, 32) -&gt; &quot;   &quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="784"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="785"></span><span style="color: rgb(63, 127, 95)">  * @inc copy-char-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="786"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="787"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">copy-char</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="788"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">copy</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="789"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="790"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="791"></span><span style="color: rgb(63, 127, 95)">   * Sorts a list of strings lexicographically, ignoring case, ascending.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="792"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="793"></span><span style="color: rgb(63, 127, 95)">   * @inc string-sort-test-a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="794"></span><span style="color: rgb(63, 127, 95)">   * @inc string-sort-test-b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="795"></span><span style="color: rgb(63, 127, 95)">   * @inc string-sort-test-c</span><span style="color: rgb(63, 127, 95)"></code>
<code id="796"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="797"></span><span style="color: rgb(63, 127, 95)">   * @type List(String) -&gt; List(String)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="798"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="799"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-sort</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="800"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="801"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">qsort</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">string-lt</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="802"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="803"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="804"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="805"></span><span style="color: rgb(63, 127, 95)">   * Sorts a list of strings lexicographically ignoring case, descending.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="806"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="807"></span><span style="color: rgb(63, 127, 95)">   * @type List(String) -&gt; List(String)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="808"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="809"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-sort-desc</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="810"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="811"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">qsort</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">string-gt</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="812"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="813"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="814"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="815"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="816"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="817"></span><span style="color: rgb(63, 127, 95)">   * Compares two strings or lists of characters lexicographically and succeeds if</span><span style="color: rgb(63, 127, 95)"></code>
<code id="818"></span><span style="color: rgb(63, 127, 95)">   * the first one is larger than the second, ignoring case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="819"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="820"></span><span style="color: rgb(63, 127, 95)">   * @type  (List(Char), List(Char)) -&gt; 1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="821"></span><span style="color: rgb(63, 127, 95)">   * @type  (String, String)         -&gt; 1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="822"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="823"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-gt</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="824"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="825"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">strcasecmp</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="826"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="827"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="828"></span><span style="color: rgb(63, 127, 95)">   * Compares two strings or lists of characters lexicographically and succeeds if</span><span style="color: rgb(63, 127, 95)"></code>
<code id="829"></span><span style="color: rgb(63, 127, 95)">   * the first one is smaller than the second, ignoring case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="830"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="831"></span><span style="color: rgb(63, 127, 95)">   * @type  (List(Char), List(Char)) -&gt; 1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="832"></span><span style="color: rgb(63, 127, 95)">   * @type  (String, String)         -&gt; 1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="833"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="834"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-lt</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="835"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="836"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">strcasecmp</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="837"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="838"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="839"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the first String starts with the second String.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="840"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="841"></span><span style="color: rgb(63, 127, 95)">   * If the strategy succeeds, the current term is left untouched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="842"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="843"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;string-starts-with(|&quot;foo&quot;)&gt; &quot;foobar&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="844"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="845"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="846"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="847"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-starts-with</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">start</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="848"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">left-match</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">start</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="849"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="850"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="851"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the first String ends with the second String.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="852"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="853"></span><span style="color: rgb(63, 127, 95)">   * If the strategy succeeds, the current term is left untouched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="854"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="855"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;string-ends-with(|&quot;bar&quot;)&gt; &quot;foobar&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="856"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="857"></span><span style="color: rgb(63, 127, 95)">   * @type  String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="858"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="859"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-ends-with</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">end</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="860"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">right-match</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">end</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="861"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="862"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="863"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="864"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the first list of terms starts with the second list of terms.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="865"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="866"></span><span style="color: rgb(63, 127, 95)">   * Returns the suffix of the first list that is not matched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="867"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="868"></span><span style="color: rgb(63, 127, 95)">   * @type  (List(a), List(a)) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="869"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="870"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">left-match</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="871"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="872"></span><span style="color: rgb(63, 127, 95)">         </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ls</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">rs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">ls</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">rs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="873"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="874"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="875"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Fst</span><span style="color: rgb(63, 127, 95)"></code>
<code id="876"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="877"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="878"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the first list of terms ends with the second list of terms.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="879"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="880"></span><span style="color: rgb(63, 127, 95)">   * Returns the prefix of the first list that is not matched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="881"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="882"></span><span style="color: rgb(63, 127, 95)">   * @type  (List(a), List(a)) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="883"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="884"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">right-match</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="885"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="886"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">left-match</span><span style="color: rgb(63, 127, 95)"></code>
<code id="887"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(63, 127, 95)"></code>
<code id="888"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(63, 127, 95)"></code>
<code id="889"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="890"></span><span style="color: rgb(63, 127, 95)">  * @inc strcmp</span><span style="color: rgb(63, 127, 95)"></code>
<code id="891"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="892"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">strcmp</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="893"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="894"></span><span style="color: rgb(63, 127, 95)">	  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="895"></span><span style="color: rgb(63, 127, 95)">	  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="896"></span><span style="color: rgb(63, 127, 95)">	  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="897"></span><span style="color: rgb(63, 127, 95)">      // these last two cases are handled faster by just !1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="898"></span><span style="color: rgb(63, 127, 95)">      //	&lt;+ \([_|_],[]) -&gt; 1\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="899"></span><span style="color: rgb(63, 127, 95)">      //	&lt;+ \([x|_],[y|_]) -&gt; 1\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="900"></span><span style="color: rgb(63, 127, 95)">	  </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="901"></span><span style="color: rgb(63, 127, 95)">	  </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="902"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="903"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="904"></span><span style="color: rgb(63, 127, 95)">   * Compares the n first characters of two character lists, n</span><span style="color: rgb(63, 127, 95)"></code>
<code id="905"></span><span style="color: rgb(63, 127, 95)">   * is given by the last argument. If the two lists are identical,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="906"></span><span style="color: rgb(63, 127, 95)">   * the integer 0 is returned, otherwise the integer 1 is returned.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="907"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="908"></span><span style="color: rgb(63, 127, 95)">   * @type List(Char) * List(Char) * Int -&gt; Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="909"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="910"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">strncmp</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(63, 127, 95)"></code>
<code id="911"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="912"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="913"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="914"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="915"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="916"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="917"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="918"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="919"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="920"></span><span style="color: rgb(63, 127, 95)">   * Compares two lists of characters lexicographically, ignoring case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="921"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="922"></span><span style="color: rgb(63, 127, 95)">   * Returns:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="923"></span><span style="color: rgb(63, 127, 95)">   *   -1 if first is smaller than the second.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="924"></span><span style="color: rgb(63, 127, 95)">   *   0  if the strings are equal.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="925"></span><span style="color: rgb(63, 127, 95)">   *   1  if the first is larger than the second.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="926"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="927"></span><span style="color: rgb(63, 127, 95)">   * @type (List(Char), List(Char)) -&gt; -1, 0,1 or -1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="928"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="929"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">strcasecmp</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(63, 127, 95)"></code>
<code id="930"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">r</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">case-char</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="931"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="932"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">case-char</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">lt</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="933"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">-1</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="934"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="935"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="936"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="937"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="938"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="939"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="940"></span><span style="color: rgb(63, 127, 95)">   * Splits a string into a list of tokens, including the empty ones.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="941"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="942"></span><span style="color: rgb(63, 127, 95)">   * This strategy differs from string-tokenize in that it produces an empty &quot;&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="943"></span><span style="color: rgb(63, 127, 95)">   * token when two separator chars are encountered, or after a final separator.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="944"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="945"></span><span style="color: rgb(63, 127, 95)">   * Example:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="946"></span><span style="color: rgb(63, 127, 95)">   *  &lt;string-tokenize-keep-empty(|['\n'])&gt; &quot;fu\n\nbar\n&quot; =&gt; [&quot;fu&quot;,&quot;&quot;,&quot;bar&quot;,&quot;&quot;]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="947"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="948"></span><span style="color: rgb(63, 127, 95)">   * @param The list of characters that may separate two tokens.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="949"></span><span style="color: rgb(63, 127, 95)">   * @type sepChars [char]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="950"></span><span style="color: rgb(63, 127, 95)">   * @type    string -&gt; [string]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="951"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="952"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="953"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-tokenize-keep-empty</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">sepChars</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="954"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="955"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">split-fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">elem</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sepChars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="956"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tchars</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">tchars</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="957"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="958"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="959"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="960"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="961"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="962"></span><span style="color: rgb(63, 127, 95)">   * Splits a string into a list of tokens, keeping the separating elements as</span><span style="color: rgb(63, 127, 95)"></code>
<code id="963"></span><span style="color: rgb(63, 127, 95)">   * 1-char-strings within the results list, *and* also keeping the empty</span><span style="color: rgb(63, 127, 95)"></code>
<code id="964"></span><span style="color: rgb(63, 127, 95)">   * &quot;&quot; tokens.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="965"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="966"></span><span style="color: rgb(63, 127, 95)">   * Example:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="967"></span><span style="color: rgb(63, 127, 95)">   *  &lt;string-tokenize-keep-all(|['\n'])&gt; &quot;fu\n\nbar\n&quot; =&gt; [&quot;fu&quot;,&quot;\n&quot;,&quot;&quot;,&quot;\n&quot;,&quot;bar&quot;,&quot;\n&quot;,&quot;&quot;]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="968"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="969"></span><span style="color: rgb(63, 127, 95)">   * @param The list of characters that may separate two tokens.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="970"></span><span style="color: rgb(63, 127, 95)">   * @type sepChars [char]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="971"></span><span style="color: rgb(63, 127, 95)">   * @type    string -&gt; [string]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="972"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="973"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="974"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-tokenize-keep-all</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">sepChars</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="975"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="976"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">split-fetch-keep</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">elem</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sepChars</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="977"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tchars</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">tchars</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="978"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="979"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="980"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="981"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="982"></span><span style="color: rgb(63, 127, 95)">   * Gets all newline(\n, \r\n or \r)-separated lines in a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="983"></span><span style="color: rgb(63, 127, 95)">   * If the string is ended by a newline, the last element of the returned list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="984"></span><span style="color: rgb(63, 127, 95)">   * is the empty string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="985"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="986"></span><span style="color: rgb(63, 127, 95)">   * @type string -&gt; [string]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="987"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="988"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="989"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">get-lines</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="990"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="991"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">split-at-newlines</span><span style="color: rgb(63, 127, 95)"></code>
<code id="992"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="993"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="994"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(127, 0, 85)">internal</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">split-at-newlines</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="995"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="996"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\n'</span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="997"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\r'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'\n'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="998"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\r'</span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="999"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1000"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">split-at-newlines</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1001"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1002"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1003"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1004"></span><span style="color: rgb(63, 127, 95)">   * Applies a strategy to all lines in a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1005"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1006"></span><span style="color: rgb(63, 127, 95)">   * Lines are expected to be separated by a single '\n'.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1007"></span><span style="color: rgb(63, 127, 95)">   * The last line may be ended by a newline, or not. In the former case, the</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1008"></span><span style="color: rgb(63, 127, 95)">   * last line in the resulting string will also be ended by a newline,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1009"></span><span style="color: rgb(63, 127, 95)">   * otherwise not.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1010"></span><span style="color: rgb(63, 127, 95)">   * Initial or intermediate newlines are preserved.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1011"></span><span style="color: rgb(63, 127, 95)">   * The strategy is applied to each line (even the empty ones), *excluding*</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1012"></span><span style="color: rgb(63, 127, 95)">   * the newline character. The newline is appended again after application of s</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1013"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1014"></span><span style="color: rgb(63, 127, 95)">   * @param The strategy that should be applied to each line.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1015"></span><span style="color: rgb(63, 127, 95)">   * @type s string -&gt; string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1016"></span><span style="color: rgb(63, 127, 95)">   * @type   string -&gt; string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1017"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1018"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1019"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">all-lines</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1020"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1021"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">string-tokenize-keep-empty</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">'\n'</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1022"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">at-last</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)">  // Do not run s on a final empty line.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1023"></span><span style="color: rgb(63, 127, 95)">           </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 255)">&quot;\n&quot;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">laststring</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> // ... but remember that the second last line was delimited by a newline</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1024"></span><span style="color: rgb(63, 127, 95)">           </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">laststring</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">    // ... or not.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1025"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1026"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 255)">&quot;\n&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1027"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">laststring</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> // Restore the final newline, if there was one.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1028"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1029"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1030"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1031"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1032"></span><span style="color: rgb(63, 127, 95)">   * Makes one newline-separated string out of a list of strings.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1033"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1034"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1035"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1036"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">lines</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1037"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 255)">&quot;\n&quot;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1038"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 255)">&quot;\n&quot;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1039"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1040"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1041"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1042"></span><span style="color: rgb(63, 127, 95)">   * Indents every line in a string with spaces.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1043"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1044"></span><span style="color: rgb(63, 127, 95)">   * @param The number of spaces to be put in front of every line.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1045"></span><span style="color: rgb(63, 127, 95)">   * @type n int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1046"></span><span style="color: rgb(63, 127, 95)">   * @type string -&gt; string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1047"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1048"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1049"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">indent-text</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1050"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">copy-char</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">' '</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">prefix</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1051"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">prefix-lines</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">prefix</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1052"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1053"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1054"></span><span style="color: rgb(63, 127, 95)">   * Prefixes all lines in a string with a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1055"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1056"></span><span style="color: rgb(63, 127, 95)">   * @param The prefix.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1057"></span><span style="color: rgb(63, 127, 95)">   * @type p string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1058"></span><span style="color: rgb(63, 127, 95)">   * @type   string -&gt; string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1059"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1060"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1061"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">prefix-lines</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">p</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1062"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">all-lines</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc-strings</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">p</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1063"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1064"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1065"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1066"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1067"></span><span style="color: rgb(63, 127, 95)">   * Trims leading characters from a string. The characters to </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1068"></span><span style="color: rgb(63, 127, 95)">   * to trim are given by the strategy argument.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1069"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1070"></span><span style="color: rgb(63, 127, 95)">   * Removes from the left-hand side all characters matched by</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1071"></span><span style="color: rgb(63, 127, 95)">   * strategy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1072"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1073"></span><span style="color: rgb(63, 127, 95)">   * Example:  &lt;ltrim-chars(?' ')&gt; &quot;   fred  &quot; =&gt; &quot;fred  &quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1074"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1075"></span><span style="color: rgb(63, 127, 95)">   * @param should match all characters to be removed</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1076"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1077"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1078"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1079"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">ltrim-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">ltrim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1080"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1081"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1082"></span><span style="color: rgb(63, 127, 95)">   * Trims trailing characters from a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1083"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1084"></span><span style="color: rgb(63, 127, 95)">   * Removes from the right-hand side all characters matched by</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1085"></span><span style="color: rgb(63, 127, 95)">   * strategy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1086"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1087"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;rtrim-chars(?' ')&gt; &quot;   fred  &quot; =&gt; &quot;   fred&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1088"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1089"></span><span style="color: rgb(63, 127, 95)">   * @param should match on all characters to be removed</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1090"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1091"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1092"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1093"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">rtrim-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">rtrim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1094"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1095"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1096"></span><span style="color: rgb(63, 127, 95)">   * Trims leading and trailing characters from a string. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1097"></span><span style="color: rgb(63, 127, 95)">   * characters to trim is given by the strategy argument.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1098"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1099"></span><span style="color: rgb(63, 127, 95)">   * Removes from both ends all characters matched by strategy</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1100"></span><span style="color: rgb(63, 127, 95)">   * s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1101"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1102"></span><span style="color: rgb(63, 127, 95)">   * Example:  &lt;trim-chars(?' ')&gt;  &quot;   fred  &quot; =&gt; &quot;fred&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1103"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1104"></span><span style="color: rgb(63, 127, 95)">   * @param should match all characters to be removed</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1105"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1106"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1107"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1108"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">trim-chars</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">string-as-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">trim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1109"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1110"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1111"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the character is whitespace.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1112"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1113"></span><span style="color: rgb(63, 127, 95)">   * Whitespace is a space (32), or a tab (9)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1114"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1115"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1116"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1117"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1118"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-whitespace</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">test</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'\t'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">' '</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1119"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1120"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1121"></span><span style="color: rgb(63, 127, 95)">   * Trims all trailing whitespace in a (single-line) string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1122"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1123"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1124"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1125"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1126"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">trim-trailing-whitespace</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1127"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">rtrim-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">is-whitespace</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1128"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1129"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1130"></span><span style="color: rgb(63, 127, 95)">   * Trims all leading whitespace in a (single-line) string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1131"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1132"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1133"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1134"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1135"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">trim-leading-whitespace</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1136"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">ltrim-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">is-whitespace</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1137"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1138"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1139"></span><span style="color: rgb(63, 127, 95)">   * Trims all trailing and leading whitespace in a (single-line) string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1140"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1141"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1142"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1143"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1144"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">trim-whitespace</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1145"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">trim-chars</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">is-whitespace</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1146"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1147"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1148"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1149"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1150"></span><span style="color: rgb(63, 127, 95)">   * Some shuffling strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1151"></span><span style="color: rgb(63, 127, 95)">   * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1152"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1153"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">shuffle-forced</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1154"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">length</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">gt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1155"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1156"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">orig</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">orig</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">shuffle</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">orig</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1157"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1158"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1159"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1160"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">shuffle</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1161"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">is-list</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1162"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">next-random</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1163"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">sort-list</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">SortL</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Fst</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Fst</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">gt</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1164"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Snd</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1165"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1166"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1167"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">shuffle-word-mids</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1168"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">string-tokenize-keep-all</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">' '</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'.'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">','</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1169"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">shuffle-word-mid</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1170"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1171"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1172"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1173"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">shuffle-word-mid</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1174"></span><span style="color: rgb(0, 64, 128)">     </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">is-string</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1175"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">strlen</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1176"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1177"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1178"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1179"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">mid</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1180"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">shuffle-forced</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">mid</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">shuffledmid</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1181"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">concat</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">shuffledmid</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1182"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1183"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1184"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1185"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1186"></span><span style="color: rgb(63, 127, 95)">   * @inc is-alphanum-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1187"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1188"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-alphanum</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">is-num</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">is-alpha</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1189"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1190"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1191"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the character is part of the lowercase or</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1192"></span><span style="color: rgb(63, 127, 95)">   * uppercase alphabet.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1193"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1194"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1195"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1196"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-alpha</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">is-upper</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">is-lower</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1197"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1198"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1199"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if applied to a character that is a hexidecimal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1200"></span><span style="color: rgb(63, 127, 95)">   * digit, i.e. either of the characters in the range '0'-'9'</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1201"></span><span style="color: rgb(63, 127, 95)">   * or 'A'-'F' or 'a'-'f'.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1202"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1203"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1204"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1205"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-hexnum</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1206"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">is-char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1207"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1208"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">is-num</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1209"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq-leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'a'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'f'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1210"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq-leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'A'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'F'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1211"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1212"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1213"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1214"></span><span style="color: rgb(63, 127, 95)">   * @inc is-num-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1215"></span><span style="color: rgb(63, 127, 95)">   * @inc is-not-num-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1216"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1217"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-num</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1218"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq-leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'0'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'9'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1219"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1220"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1221"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if this character is upper-case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1222"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1223"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1224"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1225"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-upper</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1226"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq-leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'A'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'Z'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1227"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1228"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1229"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if this character is lower-case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1230"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1231"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1232"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1233"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-lower</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1234"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq-leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">'a'</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">'z'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1235"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1236"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1237"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if this string only contains printable ASCII characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1238"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1239"></span><span style="color: rgb(63, 127, 95)">   * The letters 32 through 126, in total 96 characters, are defined</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1240"></span><span style="color: rgb(63, 127, 95)">   * as printable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1241"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1242"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1243"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1244"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-ascii</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1245"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">leq-leq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">32</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">127</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1246"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1247"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1248"></span><span style="color: rgb(63, 127, 95)">   * Applies a strategy to the upper-case variants of two characters.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1249"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1250"></span><span style="color: rgb(63, 127, 95)">   * This is useful for doing case-insenstive operations.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1251"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1252"></span><span style="color: rgb(63, 127, 95)">   * @param (Char, Char) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1253"></span><span style="color: rgb(63, 127, 95)">   * @type  (Char, Char) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1254"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1255"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">case-char</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">to-upper</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">to-upper</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1256"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1257"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1258"></span><span style="color: rgb(63, 127, 95)">   * Ensures that a character is upper-case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1259"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1260"></span><span style="color: rgb(63, 127, 95)">   * This strategy returns the input character if this</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1261"></span><span style="color: rgb(63, 127, 95)">   * character is already upper-case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1262"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1263"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1264"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1265"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">to-upper</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1266"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-lower</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">32</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1267"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1268"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1269"></span><span style="color: rgb(63, 127, 95)">   * Ensures that a character is lower-case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1270"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1271"></span><span style="color: rgb(63, 127, 95)">   * This strategy returns the input character if this</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1272"></span><span style="color: rgb(63, 127, 95)">   * character is already lower-case.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1273"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1274"></span><span style="color: rgb(63, 127, 95)">   * @type Char -&gt; Char</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1275"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1276"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">to-lower</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">is-upper</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">add</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">32</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1277"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1278"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1279"></span><span style="color: rgb(63, 127, 95)">   * Replaces one substring with another in a string.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1280"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1281"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;string-replace(|&quot;foo&quot;, &quot;bar&quot;)&gt; &quot;foobarfoo&quot; gives &quot;barbarbar&quot;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1282"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1283"></span><span style="color: rgb(63, 127, 95)">   * @param old - the old substring which is to be excised</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1284"></span><span style="color: rgb(63, 127, 95)">   * @param new - the new subtring which is to be inserted</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1285"></span><span style="color: rgb(63, 127, 95)">   * @type String -&gt; String</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1286"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1287"></span><span style="color: rgb(63, 127, 95)">   * @author Karl Trygve Kalleberg &lt;karltk@stratego.org&gt;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1288"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1289"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">string-replace</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1290"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1291"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">internal-string-replace</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">explode-string</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1292"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1293"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">implode-string</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1294"></span><span style="color: rgb(63, 127, 95)">  </code>
<code id="1295"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1296"></span><span style="color: rgb(63, 127, 95)"> </code>
<code id="1297"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1298"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">internal-string-replace</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1299"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">hd</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cur</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1300"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1301"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">cur</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">hd</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ctl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1302"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ctl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1303"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">internal-string-replace-found</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1304"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">internal-string-replace</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1305"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1306"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">hd</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cur</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1307"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">internal-string-replace</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1308"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1309"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1310"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1311"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">internal-string-replace</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1312"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1313"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1314"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1315"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">internal-string-replace-found</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1316"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">hd</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">cur</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1317"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">cur</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">hd</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ctl</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1318"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ctl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1319"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">internal-string-replace-found</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1320"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1321"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1322"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">internal-string-replace-found</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1323"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">rest</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">new</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">pre</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">rest</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">old</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1324"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1325"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1326"></span><span style="color: rgb(63, 127, 95)">  * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1327"></span><span style="color: rgb(63, 127, 95)">  * Used by desugaring of string interpolation $[... [x] ...]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1328"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1329"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">internal-ensure-as-string</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1330"></span><span style="color: rgb(0, 64, 128)">  	</span><span style="color: rgb(0, 64, 128)">concat-strings</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1331"></span><span style="color: rgb(63, 127, 95)">  	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">is-string</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1332"></span><span style="color: rgb(63, 127, 95)">  	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">int-to-string</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1333"></span><span style="color: rgb(63, 127, 95)">  	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">real-to-string</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1334"></span><span style="color: rgb(63, 127, 95)">  	</span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1335"></span><span style="color: rgb(63, 127, 95)">  		</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1336"></span><span style="color: rgb(63, 127, 95)">  		</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_stacktrace_get_all_frame_names&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1337"></span><span style="color: rgb(63, 127, 95)">  		</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1338"></span><span style="color: rgb(63, 127, 95)">  		</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">report-failure</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 255)">&quot;Internal error: escaped term in string quotation is not a string&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1339"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1340"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1341"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1342"></span><span style="color: rgb(63, 127, 95)">  * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1343"></span><span style="color: rgb(63, 127, 95)">  * Used by desugaring of string interpolation $[... [x] ...]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1344"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1345"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">internal-string-interpolation</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">padded_s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">internal-ensure-as-string</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">string-replace</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 255)">&quot;\n&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">padded_s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="1346"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1347"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1348"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1349"></span></code>
