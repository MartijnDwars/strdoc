<code id="0"><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1"></span><span style="color: rgb(63, 127, 95)"> * This module contains basic functionality for manipulating lists.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="2"></span><span style="color: rgb(63, 127, 95)"> *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="3"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="4"></span><span style="color: rgb(127, 0, 85)">module</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">collection/list/common</span><span style="color: rgb(63, 127, 95)"></code>
<code id="5"></span><span style="color: rgb(127, 0, 85)">imports</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="6"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list/cons</span><span style="color: rgb(63, 127, 95)"></code>
<code id="7"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list/index</span><span style="color: rgb(63, 127, 95)"></code>
<code id="8"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">term/integer</span><span style="color: rgb(63, 127, 95)"></code>
<code id="9"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="10"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="11"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="12"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="13"></span><span style="color: rgb(63, 127, 95)">   * Iterative loop over a list applying s to each element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="14"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="15"></span><span style="color: rgb(63, 127, 95)">   * @param Strategy to apply to every element (a -&gt; _)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="16"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="17"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="18"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list-loop</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="19"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_list_loop&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="20"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="21"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="22"></span><span style="color: rgb(63, 127, 95)">   * Iterative fold over a list applying s to each element and </span><span style="color: rgb(63, 127, 95)"></code>
<code id="23"></span><span style="color: rgb(63, 127, 95)">   * accumulator acc from left to right.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="24"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="25"></span><span style="color: rgb(63, 127, 95)">   * @param Strategy applied for folding. The current</span><span style="color: rgb(63, 127, 95)"></code>
<code id="26"></span><span style="color: rgb(63, 127, 95)">   *        intermediate result is a term argument. The next element</span><span style="color: rgb(63, 127, 95)"></code>
<code id="27"></span><span style="color: rgb(63, 127, 95)">   *        of the list is the current term.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="28"></span><span style="color: rgb(63, 127, 95)">   * @param Initial value for folding (type: c)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="29"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; c</span><span style="color: rgb(63, 127, 95)"></code>
<code id="30"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="31"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list-fold</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">acc</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="32"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_list_fold&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">acc</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="33"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="34"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="35"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="36"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="37"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"></code>
<code id="38"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="39"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="40"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(63, 127, 95)"></code>
<code id="41"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="42"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="43"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Last</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"></code>
<code id="44"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="45"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="46"></span><span style="color: rgb(63, 127, 95)">   * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="47"></span><span style="color: rgb(63, 127, 95)">   * @type a -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="48"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="49"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">MkSingleton</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="50"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="51"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="52"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="53"></span><span style="color: rgb(63, 127, 95)">   * Splits a Cons into a tuple with head and tail.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="54"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="55"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; (a, List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="56"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="57"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-Cons</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="58"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="59"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="60"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="61"></span><span style="color: rgb(63, 127, 95)">   * Makes a Cons out of a tuple with head and tail. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="62"></span><span style="color: rgb(63, 127, 95)">   * tail must be a list, but may be the empty list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="63"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="64"></span><span style="color: rgb(63, 127, 95)">   * @type (a, List(a)) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="65"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="66"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">MkCons</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="67"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="68"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="69"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="70"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="71"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="72"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the input term is a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="73"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="74"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="75"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="76"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-list</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="77"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="78"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="79"></span><span style="color: rgb(63, 127, 95)">   * Apply a strategy to each element of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="80"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="81"></span><span style="color: rgb(63, 127, 95)">   * @param s is applied to all elements: a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="82"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="83"></span><span style="color: rgb(63, 127, 95)">   * @inc   map-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="84"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="85"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="86"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="87"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="88"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="89"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">map1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="90"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">map1</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map1</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="91"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="92"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="93"></span><span style="color: rgb(63, 127, 95)">   * In reverse order, apply a strategy to each element of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="94"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="95"></span><span style="color: rgb(63, 127, 95)">   * @param s is applied to all elements: a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="96"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="97"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="98"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">reverse-map</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="99"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse-map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="100"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="101"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="102"></span><span style="color: rgb(63, 127, 95)">   * @inc map</span><span style="color: rgb(63, 127, 95)"></code>
<code id="103"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="104"></span><span style="color: rgb(63, 127, 95)">   * @note list(s) is an alias for map</span><span style="color: rgb(63, 127, 95)"></code>
<code id="105"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="106"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="107"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="108"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="109"></span><span style="color: rgb(63, 127, 95)">  /** </span><span style="color: rgb(63, 127, 95)"></code>
<code id="110"></span><span style="color: rgb(63, 127, 95)">   * Apply a strategy to some elements in a list. The elements</span><span style="color: rgb(63, 127, 95)"></code>
<code id="111"></span><span style="color: rgb(63, 127, 95)">   * of the original list will be kept unchanged when the </span><span style="color: rgb(63, 127, 95)"></code>
<code id="112"></span><span style="color: rgb(63, 127, 95)">   * strategy s fails.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="113"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="114"></span><span style="color: rgb(63, 127, 95)">   * @param s       a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="115"></span><span style="color: rgb(63, 127, 95)">   * @type    List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="116"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="117"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list-some</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="118"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">list</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="119"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="120"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="121"></span><span style="color: rgb(63, 127, 95)">  * Returns the length of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="122"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="123"></span><span style="color: rgb(63, 127, 95)">  * @type List(a) -&gt; Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="124"></span><span style="color: rgb(63, 127, 95)">  * @inc length-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="125"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="126"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">length</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="127"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_get_list_length&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="128"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="129"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="130"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the term is in the list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="131"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="132"></span><span style="color: rgb(63, 127, 95)">   * @type  (a, List(a)) -&gt;? List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="133"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="134"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">elem</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="135"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="136"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="137"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="138"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the term is in the list, using the given</span><span style="color: rgb(63, 127, 95)"></code>
<code id="139"></span><span style="color: rgb(63, 127, 95)">   * strategy for determining equality.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="140"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="141"></span><span style="color: rgb(63, 127, 95)">   * @param (a, a) -&gt;? b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="142"></span><span style="color: rgb(63, 127, 95)">   * @type  (a, List(a)) -&gt;? List(a or b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="143"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="144"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">elem</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">eq</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="145"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="146"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="147"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="148"></span><span style="color: rgb(63, 127, 95)">   * Find first list element for which s succeeds.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="149"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="150"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="151"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a or b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="152"></span><span style="color: rgb(63, 127, 95)">   * @inc   fetch-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="153"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="154"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="155"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="156"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="157"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="158"></span><span style="color: rgb(63, 127, 95)">   * Return first list element for which s succeeds.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="159"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="160"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="161"></span><span style="color: rgb(63, 127, 95)">   * @inc   fetch-elem-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="162"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="163"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">fetch-elem</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="164"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"></code>
<code id="165"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="166"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="167"></span><span style="color: rgb(63, 127, 95)">   * Splits a list in two parts at the first point where s succeeds.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="168"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="169"></span><span style="color: rgb(63, 127, 95)">   * The element to which s was applied is not part of the result. split-fetch</span><span style="color: rgb(63, 127, 95)"></code>
<code id="170"></span><span style="color: rgb(63, 127, 95)">   * fails if s cannot be applied to any of the elements.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="171"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="172"></span><span style="color: rgb(63, 127, 95)">   * Examples:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="173"></span><span style="color: rgb(63, 127, 95)">   *   &lt;split-fetch(\ 3 -&gt; 6 \)&gt; [1, 2, 3] =&gt; ([1,2], [])</span><span style="color: rgb(63, 127, 95)"></code>
<code id="174"></span><span style="color: rgb(63, 127, 95)">   *   &lt;split-fetch(\ 3 -&gt; 6 \)&gt; [2, 3, 4] =&gt; ([2], [4])</span><span style="color: rgb(63, 127, 95)"></code>
<code id="175"></span><span style="color: rgb(63, 127, 95)">   *   &lt;split-fetch(\ 3 -&gt; 6 \)&gt; [3, 4, 5] =&gt; ([], [4,5])</span><span style="color: rgb(63, 127, 95)"></code>
<code id="176"></span><span style="color: rgb(63, 127, 95)">   *   not(&lt;split-fetch(\ 3 -&gt; 6 \)&gt; [8, 7, 6])</span><span style="color: rgb(63, 127, 95)"></code>
<code id="177"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="178"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt;? _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="179"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; (List(a), List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="180"></span><span style="color: rgb(63, 127, 95)">   * @inc   split-fetch-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="181"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="182"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-fetch</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="183"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="184"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="185"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="186"></span><span style="color: rgb(63, 127, 95)">   * Splits a list in two parts at the point where s succeeds, keeping the</span><span style="color: rgb(63, 127, 95)"></code>
<code id="187"></span><span style="color: rgb(63, 127, 95)">   * element at which s succeeded.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="188"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="189"></span><span style="color: rgb(63, 127, 95)">   * Unlike split-fetch, this strategy keeps the dividing element as part of</span><span style="color: rgb(63, 127, 95)"></code>
<code id="190"></span><span style="color: rgb(63, 127, 95)">   * the result as the second element in the triple: (before, split, after)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="191"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="192"></span><span style="color: rgb(63, 127, 95)">   * split-fetch-keep fails if s cannot be applied to any of the elements.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="193"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="194"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="195"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; (List(a), b, List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="196"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="197"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-fetch-keep</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="198"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">el</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">el</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="199"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(63, 127, 95)"></code>
<code id="200"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="201"></span><span style="color: rgb(63, 127, 95)">   * Breaks a list into multiple parts (tokens). </span><span style="color: rgb(63, 127, 95)"></code>
<code id="202"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="203"></span><span style="color: rgb(63, 127, 95)">   * The term argument sep is a list of delimiters (elements that separate</span><span style="color: rgb(63, 127, 95)"></code>
<code id="204"></span><span style="color: rgb(63, 127, 95)">   * tokens from one another), which is used to split the list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="205"></span><span style="color: rgb(63, 127, 95)">   * into multiple tokens. The result is a list of lists, i.e. a list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="206"></span><span style="color: rgb(63, 127, 95)">   * of tokens.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="207"></span><span style="color: rgb(63, 127, 95)">   *  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="208"></span><span style="color: rgb(63, 127, 95)">   * @param List of separator elements.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="209"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="210"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="211"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list-tokenize</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="212"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">list-tokenize</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">c</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="213"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="214"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="215"></span><span style="color: rgb(63, 127, 95)">   * Breaks a list into multiple parts (tokens). </span><span style="color: rgb(63, 127, 95)"></code>
<code id="216"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="217"></span><span style="color: rgb(63, 127, 95)">   * The strategy argument sep is used to split the list. Wherever it</span><span style="color: rgb(63, 127, 95)"></code>
<code id="218"></span><span style="color: rgb(63, 127, 95)">   * succeeds, the original list is split, and the parts are returned</span><span style="color: rgb(63, 127, 95)"></code>
<code id="219"></span><span style="color: rgb(63, 127, 95)">   * as a list of lists, i.e. a list of tokens.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="220"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="221"></span><span style="color: rgb(63, 127, 95)">   * @param s  a -&gt; fail?</span><span style="color: rgb(63, 127, 95)"></code>
<code id="222"></span><span style="color: rgb(63, 127, 95)">   * @type     List(a) -&gt; List(List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="223"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="224"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list-tokenize</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="225"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">split-fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">sep</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="226"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="227"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">@</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="228"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">@</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">list-tokenize</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">sep</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="229"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">@</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">@</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">list-tokenize</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">sep</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="230"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="231"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="232"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(63, 127, 95)"></code>
<code id="233"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="234"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="235"></span><span style="color: rgb(63, 127, 95)">   * Apply a strategy to the tail of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="236"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="237"></span><span style="color: rgb(63, 127, 95)">   * @param is applied to the tail: List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="238"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a or b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="239"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="240"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">at-tail</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="241"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="242"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="243"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="244"></span><span style="color: rgb(63, 127, 95)">   * Apply s to the Nil of a list. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="245"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="246"></span><span style="color: rgb(63, 127, 95)">   * @param is applied to Nil ([]) and must return a list: List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="247"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="248"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="249"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">at-end</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="250"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="251"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="252"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="253"></span><span style="color: rgb(63, 127, 95)">   * Apply a strategy to some suffix of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="254"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="255"></span><span style="color: rgb(63, 127, 95)">   * The longest suffix (that is, the first application in a list)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="256"></span><span style="color: rgb(63, 127, 95)">   * is preferred.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="257"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="258"></span><span style="color: rgb(63, 127, 95)">   * @param is applied to the suffix : List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="259"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a or b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="260"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="261"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="262"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="263"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="264"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="265"></span><span style="color: rgb(63, 127, 95)">   * Apply a strategy to some suffix of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="266"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="267"></span><span style="color: rgb(63, 127, 95)">   * The shortest suffix (that is, the last application in a list)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="268"></span><span style="color: rgb(63, 127, 95)">   * is preferred.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="269"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="270"></span><span style="color: rgb(63, 127, 95)">   * @param is applied to the suffix : List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="271"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a or b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="272"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="273"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">at-suffix-rev</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="274"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="275"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="276"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="277"></span><span style="color: rgb(63, 127, 95)">   * Apply s to the last Cons ([_]) of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="278"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="279"></span><span style="color: rgb(63, 127, 95)">   * @param Is applied to the [x] and must return a list: List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="280"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="281"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="282"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">at-last</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="283"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="284"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="285"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="286"></span><span style="color: rgb(63, 127, 95)">   * Splits a list into a tuple of its init list and last element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="287"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="288"></span><span style="color: rgb(63, 127, 95)">   * Example:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="289"></span><span style="color: rgb(63, 127, 95)">   *   &lt;split-init-last&gt; [1, 2, 3, 4] =&gt; ([1, 2, 3], 4)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="290"></span><span style="color: rgb(63, 127, 95)">   *   &lt;split-init-last&gt; [1]          =&gt; ([], 1)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="291"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="292"></span><span style="color: rgb(63, 127, 95)">   * @type   List(a) -&gt; (List(a), a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="293"></span><span style="color: rgb(63, 127, 95)">   * @inc    split-init-last</span><span style="color: rgb(63, 127, 95)"></code>
<code id="294"></span><span style="color: rgb(63, 127, 95)">   * @since  0.9.4</span><span style="color: rgb(63, 127, 95)"></code>
<code id="295"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="296"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-init-last</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="297"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-last</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="298"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="299"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="300"></span><span style="color: rgb(63, 127, 95)">   * Applies s1 to all elements in a list, except the last, where</span><span style="color: rgb(63, 127, 95)"></code>
<code id="301"></span><span style="color: rgb(63, 127, 95)">   * s2 is applied.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="302"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="303"></span><span style="color: rgb(63, 127, 95)">   * @param s1 a -&gt; b </span><span style="color: rgb(63, 127, 95)"></code>
<code id="304"></span><span style="color: rgb(63, 127, 95)">   * @param s2 a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="305"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="306"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="307"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">at-init</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="308"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="309"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="310"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="311"></span><span style="color: rgb(63, 127, 95)">   * Applies a strategy to a list in bottom up order. That is to say,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="312"></span><span style="color: rgb(63, 127, 95)">   * the strategy s will be applied to successively longer excerpts</span><span style="color: rgb(63, 127, 95)"></code>
<code id="313"></span><span style="color: rgb(63, 127, 95)">   * of the list, starting from the end. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="314"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="315"></span><span style="color: rgb(63, 127, 95)">   * At the first invocation, s will be applied to the tail of the list,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="316"></span><span style="color: rgb(63, 127, 95)">   * and is expected to return a new list. The last element of the list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="317"></span><span style="color: rgb(63, 127, 95)">   * will then be added in front of this result, and s is applied to</span><span style="color: rgb(63, 127, 95)"></code>
<code id="318"></span><span style="color: rgb(63, 127, 95)">   * this. The recursion continues through all elements from last to</span><span style="color: rgb(63, 127, 95)"></code>
<code id="319"></span><span style="color: rgb(63, 127, 95)">   * first, each time on a longer list, hence &quot;bottom up&quot;.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="320"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="321"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;listbu(![9 | &lt;id&gt;])&gt; [1,2,3,4] =&gt; [9,1,9,2,9,3,9,4,9]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="322"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="323"></span><span style="color: rgb(63, 127, 95)">   * @param s  List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="324"></span><span style="color: rgb(63, 127, 95)">   * @type     List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="325"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="326"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">listbu</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="327"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="328"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="329"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="330"></span><span style="color: rgb(63, 127, 95)">   * @inc listbu</span><span style="color: rgb(63, 127, 95)"></code>
<code id="331"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="332"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">listbu1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="333"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">listbu1</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"></code>
<code id="334"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="335"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="336"></span><span style="color: rgb(63, 127, 95)">   * Applies a strategy to a list in top down order. That is to say,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="337"></span><span style="color: rgb(63, 127, 95)">   * the strategy s will first be applied to the whole list, then </span><span style="color: rgb(63, 127, 95)"></code>
<code id="338"></span><span style="color: rgb(63, 127, 95)">   * successively shorter excerpts, all the way chopping of elements from</span><span style="color: rgb(63, 127, 95)"></code>
<code id="339"></span><span style="color: rgb(63, 127, 95)">   * the start of the list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="340"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="341"></span><span style="color: rgb(63, 127, 95)">   * At the first invocation, s will be applied to the whole list, and</span><span style="color: rgb(63, 127, 95)"></code>
<code id="342"></span><span style="color: rgb(63, 127, 95)">   * is expected to return a new list. The first element is chopped off</span><span style="color: rgb(63, 127, 95)"></code>
<code id="343"></span><span style="color: rgb(63, 127, 95)">   * this result, and s is applied again, until s has been applied to</span><span style="color: rgb(63, 127, 95)"></code>
<code id="344"></span><span style="color: rgb(63, 127, 95)">   * the empty list. The recursion continues through successively </span><span style="color: rgb(63, 127, 95)"></code>
<code id="345"></span><span style="color: rgb(63, 127, 95)">   * shorter list, hence &quot;top down&quot;.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="346"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="347"></span><span style="color: rgb(63, 127, 95)">   * @note The strategy s cannot result in a list which is longer than</span><span style="color: rgb(63, 127, 95)"></code>
<code id="348"></span><span style="color: rgb(63, 127, 95)">   * it is given, because that will result in non-termination.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="349"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="350"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;listtd(not(?[]) ; ![&lt;sum&gt;] &lt;+ ![])&gt; [1,2,3,4] =&gt; [10]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="351"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="352"></span><span style="color: rgb(63, 127, 95)">   * @param s  List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="353"></span><span style="color: rgb(63, 127, 95)">   * @type     List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="354"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="355"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">listtd</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="356"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="357"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="358"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="359"></span><span style="color: rgb(63, 127, 95)">   * Applies s in a top down then bottom up, i.e. down up, order. See</span><span style="color: rgb(63, 127, 95)"></code>
<code id="360"></span><span style="color: rgb(63, 127, 95)">   * listtd and listbu for a detailed description of each phase.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="361"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="362"></span><span style="color: rgb(63, 127, 95)">   * @note As with listtd, the strategy s can never result in a list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="363"></span><span style="color: rgb(63, 127, 95)">   * which is longer than given to it.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="364"></span><span style="color: rgb(63, 127, 95)">   *   </span><span style="color: rgb(63, 127, 95)"></code>
<code id="365"></span><span style="color: rgb(63, 127, 95)">   * @param s List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="366"></span><span style="color: rgb(63, 127, 95)">   * @type    List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="367"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="368"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">listdu</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="369"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="370"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="371"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="372"></span><span style="color: rgb(63, 127, 95)">   * Applies s1 in a top down order then s2 in a bottom up order. See</span><span style="color: rgb(63, 127, 95)"></code>
<code id="373"></span><span style="color: rgb(63, 127, 95)">   * listd and listbu for a detailed description of each phase.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="374"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="375"></span><span style="color: rgb(63, 127, 95)">   * @note As with listtd, the strategy s2 can never result in a list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="376"></span><span style="color: rgb(63, 127, 95)">   * which is longer than given to it.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="377"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="378"></span><span style="color: rgb(63, 127, 95)">   * @param s1 List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="379"></span><span style="color: rgb(63, 127, 95)">   * @param s2 List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="380"></span><span style="color: rgb(63, 127, 95)">   * @type     List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="381"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="382"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">listdu2</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="383"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="384"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="385"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="386"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">RevInit</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="387"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="388"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="389"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Rev</span><span style="color: rgb(0, 64, 128)">     </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="390"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="391"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="392"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">RevExit</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(63, 127, 95)"></code>
<code id="393"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="394"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="395"></span><span style="color: rgb(63, 127, 95)">   * Reverses a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="396"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="397"></span><span style="color: rgb(63, 127, 95)">   * @inc reverse-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="398"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="399"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="400"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="401"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">reverse-acc</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="402"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="403"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="404"></span><span style="color: rgb(63, 127, 95)">   * Reverses a list and applies s to all the elements.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="405"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="406"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="407"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="408"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="409"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">reverse</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="410"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">reverse-acc</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="411"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="412"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="413"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">reverse-acc</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">acc</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="414"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">acc</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="415"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="416"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="417"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">reverse-acc</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">acc</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="418"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">acc</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">reverse-acc</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="419"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="420"></span><span style="color: rgb(127, 0, 85)">rules</span><span style="color: rgb(63, 127, 95)"></code>
<code id="421"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="422"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="423"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UptoInit</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="424"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="425"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="426"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UptoExit</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="427"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="428"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="429"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">UptoStep</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">i</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="430"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="431"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="432"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="433"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="434"></span><span style="color: rgb(63, 127, 95)">   * Generates a sequence of numbers from 0 up to the given input</span><span style="color: rgb(63, 127, 95)"></code>
<code id="435"></span><span style="color: rgb(63, 127, 95)">   * integer, inclusive. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="436"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="437"></span><span style="color: rgb(63, 127, 95)">   * See also range.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="438"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="439"></span><span style="color: rgb(63, 127, 95)">   * @type Int -&gt; List(Int)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="440"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="441"></span><span style="color: rgb(63, 127, 95)">   * @inc upto-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="442"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="443"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">upto</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="444"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">UptoInit</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">UptoExit</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">UptoStep</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="445"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="446"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="447"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="448"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="449"></span><span style="color: rgb(63, 127, 95)">   * Concatenates all lists of a tuple.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="450"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="451"></span><span style="color: rgb(63, 127, 95)">   * @type (List(a), List(a), ...) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="452"></span><span style="color: rgb(63, 127, 95)">   * @inc  conc-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="453"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="454"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="455"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">at-end</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">l2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">l1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="456"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">concat</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="457"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="458"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="459"></span><span style="color: rgb(63, 127, 95)">   * Concatenates a list of lists into one list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="460"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="461"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;concat&gt; [[1,2],[3,4],[5,6]] =&gt; [1,2,3,4,5,6]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="462"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="463"></span><span style="color: rgb(63, 127, 95)">   * @type List(List(a)) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="464"></span><span style="color: rgb(63, 127, 95)">   * @inc  concat-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="465"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="466"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">concat</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="467"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ls</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">at-end</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ls</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="468"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="469"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="470"></span><span style="color: rgb(63, 127, 95)">   * Concats two elements if both elements are lists. Otherwise, constructs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="471"></span><span style="color: rgb(63, 127, 95)">   * a Conc term.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="472"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="473"></span><span style="color: rgb(63, 127, 95)">   * Generic term construction is used to avoid infinite recursion: makeConc</span><span style="color: rgb(63, 127, 95)"></code>
<code id="474"></span><span style="color: rgb(63, 127, 95)">   * is used in the compilation of Conc itself.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="475"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="476"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) * List(b) -&gt; List(a|b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="477"></span><span style="color: rgb(63, 127, 95)">   * @type a * b -&gt; Conc(a,b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="478"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="479"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">makeConc</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="480"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="481"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">is-list</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">is-list</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 255)">&quot;Conc&quot;</span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="482"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="483"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="484"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="485"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="486"></span><span style="color: rgb(63, 127, 95)">   * Separates the elements of the list by the specified separator.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="487"></span><span style="color: rgb(63, 127, 95)">   * The separate-by variant that uses a term argument is prefered.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="488"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="489"></span><span style="color: rgb(63, 127, 95)">   * @type (sep, List(a)) -&gt; List(a or sep)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="490"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="491"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="492"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="493"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="494"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="495"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="496"></span><span style="color: rgb(63, 127, 95)">   * Separates the elements of the list by the specified separator.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="497"></span><span style="color: rgb(63, 127, 95)">   * The separate-by variant that uses a term argument is prefered.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="498"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="499"></span><span style="color: rgb(63, 127, 95)">   * @param Strategy that results in a separator.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="500"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a or sep)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="501"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="502"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="503"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">sep</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="504"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="505"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="506"></span><span style="color: rgb(63, 127, 95)">   * Separates the elements of the list by the specified separator.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="507"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="508"></span><span style="color: rgb(63, 127, 95)">   * @param Separator term</span><span style="color: rgb(63, 127, 95)"></code>
<code id="509"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a or sep)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="510"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="511"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">separate-by</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="512"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="513"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"></code>
<code id="514"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="515"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="516"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="517"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">sep</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="518"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="519"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="520"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="521"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="522"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="523"></span><span style="color: rgb(63, 127, 95)">   * Transposes an n by m matrix. The matrix must be represented as</span><span style="color: rgb(63, 127, 95)"></code>
<code id="524"></span><span style="color: rgb(63, 127, 95)">   * a list of n elements, where each element is a list of length m.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="525"></span><span style="color: rgb(63, 127, 95)">   * The element of the inner lists may be of any type.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="526"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="527"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;matrix-transpose&gt; [[1,2],[3,4]] =&gt; [[1,3],[2,4]]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="528"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="529"></span><span style="color: rgb(63, 127, 95)">   * @type List(List(a)) -&gt; List(List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="530"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="531"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">matrix-transpose</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="532"></span><span style="color: rgb(0, 64, 128)">      </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="533"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">split-Cons</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="534"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">unzip</span><span style="color: rgb(63, 127, 95)"></code>
<code id="535"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">matrix-transpose</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="536"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">MkCons</span><span style="color: rgb(63, 127, 95)"></code>
<code id="537"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="538"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="539"></span><span style="color: rgb(63, 127, 95)">   * &lt;for-each-pair(s)&gt; (xs, ys) produces the list of pairs &lt;s&gt; (x,y).</span><span style="color: rgb(63, 127, 95)"></code>
<code id="540"></span><span style="color: rgb(63, 127, 95)">   * for each pair of x from xs and y from ys.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="541"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="542"></span><span style="color: rgb(63, 127, 95)">   * @inc for-each-pair-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="543"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="544"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) * List(b) -&gt; List((a,b), ...)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="545"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="546"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">for-each-pair</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="547"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="548"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="549"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="550"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="551"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="552"></span><span style="color: rgb(63, 127, 95)">   * Succeeds if the first input term is a member of the second.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="553"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="554"></span><span style="color: rgb(63, 127, 95)">   * @type a * List(a) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="555"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="556"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">member</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="557"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="558"></span><span style="color: rgb(127, 0, 85)">rules</span><span style="color: rgb(63, 127, 95)"></code>
<code id="559"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="560"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="561"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">FoldR1</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="562"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="563"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="564"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">FoldR</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="565"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="566"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="567"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">FoldL</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="568"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="569"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="570"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">lsplit</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">f</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">g</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">g</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="571"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="572"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="573"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="574"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="575"></span><span style="color: rgb(63, 127, 95)">   * foldr, requires a list of length &gt; 1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="576"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="577"></span><span style="color: rgb(63, 127, 95)">   * @param  List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="578"></span><span style="color: rgb(63, 127, 95)">   * @param  (a, b) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="579"></span><span style="color: rgb(63, 127, 95)">   * @type   List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="580"></span><span style="color: rgb(63, 127, 95)">   * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="581"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="582"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">foldr1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="583"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">FoldR</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="584"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="585"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="586"></span><span style="color: rgb(63, 127, 95)">   * foldr, requires a list of length &gt; 1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="587"></span><span style="color: rgb(63, 127, 95)">   * The additional parameter strategy f is applied to each element just</span><span style="color: rgb(63, 127, 95)"></code>
<code id="588"></span><span style="color: rgb(63, 127, 95)">   * before each folding step.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="589"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="590"></span><span style="color: rgb(63, 127, 95)">   * @param List(c) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="591"></span><span style="color: rgb(63, 127, 95)">   * @param (c, b) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="592"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt; c</span><span style="color: rgb(63, 127, 95)"></code>
<code id="593"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="594"></span><span style="color: rgb(63, 127, 95)">   * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="595"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="596"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">foldr1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">f</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="597"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">FoldR</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="598"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="599"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="600"></span><span style="color: rgb(63, 127, 95)">   * foldr, requires a list of length &gt; 1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="601"></span><span style="color: rgb(63, 127, 95)">   * Note that s maps (a, a) to a, only one type is involved.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="602"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="603"></span><span style="color: rgb(63, 127, 95)">   * @param (a, a) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="604"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="605"></span><span style="color: rgb(63, 127, 95)">   * @internal</span><span style="color: rgb(63, 127, 95)"></code>
<code id="606"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="607"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">foldr1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="608"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">FoldR1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">FoldR</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="609"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="610"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="611"></span><span style="color: rgb(63, 127, 95)">   * Right folds a list. That is, the strategy s2 is applied as a </span><span style="color: rgb(63, 127, 95)"></code>
<code id="612"></span><span style="color: rgb(63, 127, 95)">   * binary operator between all adjacent elements in the list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="613"></span><span style="color: rgb(63, 127, 95)">   * foldr starts by applying s2 to the last element in the list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="614"></span><span style="color: rgb(63, 127, 95)">   * and the result of s1. s1 is therefore the starting point of</span><span style="color: rgb(63, 127, 95)"></code>
<code id="615"></span><span style="color: rgb(63, 127, 95)">   * the folding.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="616"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="617"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;foldr(!0, add)&gt; [1,2,3,4] =&gt; 10</span><span style="color: rgb(63, 127, 95)"></code>
<code id="618"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="619"></span><span style="color: rgb(63, 127, 95)">   * @param [] -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="620"></span><span style="color: rgb(63, 127, 95)">   * @param (a, b) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="621"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="622"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="623"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="624"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="625"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="626"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="627"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="628"></span><span style="color: rgb(63, 127, 95)">   * Right folds a list. That is, the strategy s2 is applied as a </span><span style="color: rgb(63, 127, 95)"></code>
<code id="629"></span><span style="color: rgb(63, 127, 95)">   * binary operator between all adjacent elements in the list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="630"></span><span style="color: rgb(63, 127, 95)">   * foldr starts by applying s2 to the last element in the list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="631"></span><span style="color: rgb(63, 127, 95)">   * and the result of s1. s1 is therefore the starting point of</span><span style="color: rgb(63, 127, 95)"></code>
<code id="632"></span><span style="color: rgb(63, 127, 95)">   * the folding.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="633"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="634"></span><span style="color: rgb(63, 127, 95)">   * The additional parameter strategy f is applied to each element just</span><span style="color: rgb(63, 127, 95)"></code>
<code id="635"></span><span style="color: rgb(63, 127, 95)">   * before each folding step.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="636"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="637"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;foldr(!0, add, inc)&gt; [1,2,3,4] =&gt; 14</span><span style="color: rgb(63, 127, 95)"></code>
<code id="638"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="639"></span><span style="color: rgb(63, 127, 95)">   * @param [] -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="640"></span><span style="color: rgb(63, 127, 95)">   * @param (c, b) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="641"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt; c</span><span style="color: rgb(63, 127, 95)"></code>
<code id="642"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="643"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="644"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">f</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="645"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="646"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="647"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="648"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="649"></span><span style="color: rgb(63, 127, 95)">   * Left folds a list. That is, the strategy sis applied as a </span><span style="color: rgb(63, 127, 95)"></code>
<code id="650"></span><span style="color: rgb(63, 127, 95)">   * binary operator between all adjacent elements in the list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="651"></span><span style="color: rgb(63, 127, 95)">   * foldr starts by applying s to b and the first element in</span><span style="color: rgb(63, 127, 95)"></code>
<code id="652"></span><span style="color: rgb(63, 127, 95)">   * the list. b is therefore the starting point of the folding.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="653"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="654"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;foldl(add)&gt; ([1,2,3,4], 0)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="655"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="656"></span><span style="color: rgb(63, 127, 95)">   * @param (a, b) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="657"></span><span style="color: rgb(63, 127, 95)">   * @type  (List(a), b) -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="658"></span><span style="color: rgb(63, 127, 95)">   */ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="659"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">foldl</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="660"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">FoldL</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="661"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="662"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="663"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">mapfoldr1</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s3</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="664"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">b</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">b</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="665"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="666"></span><span style="color: rgb(63, 127, 95)">  /** </span><span style="color: rgb(63, 127, 95)"></code>
<code id="667"></span><span style="color: rgb(63, 127, 95)">   * Transform the elements of a list into lists (map)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="668"></span><span style="color: rgb(63, 127, 95)">   * and concatenate into a single list (concat).</span><span style="color: rgb(63, 127, 95)"></code>
<code id="669"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="670"></span><span style="color: rgb(63, 127, 95)">   * Note: equivalent to map(s); concat</span><span style="color: rgb(63, 127, 95)"></code>
<code id="671"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="672"></span><span style="color: rgb(63, 127, 95)">   * @param a -&gt; List(b) </span><span style="color: rgb(63, 127, 95)"></code>
<code id="673"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="674"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="675"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">mapconcat</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="676"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="677"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="678"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="679"></span><span style="color: rgb(63, 127, 95)">   * Returns the last element of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="680"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="681"></span><span style="color: rgb(63, 127, 95)">   * Fails if applied to the empty list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="682"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="683"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="684"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="685"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">last</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="686"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Last</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="687"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="688"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="689"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="690"></span><span style="color: rgb(63, 127, 95)">   * Returns a list with the first and the last element of</span><span style="color: rgb(63, 127, 95)"></code>
<code id="691"></span><span style="color: rgb(63, 127, 95)">   * the input list. For the empty list and the singleton</span><span style="color: rgb(63, 127, 95)"></code>
<code id="692"></span><span style="color: rgb(63, 127, 95)">   * list, this is equivalent to id.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="693"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="694"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="695"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="696"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">first-last</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="697"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">try</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">last</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">MkSingleton</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="698"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="699"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="700"></span><span style="color: rgb(63, 127, 95)">  * Returns a list of all elements of a list, except the last.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="701"></span><span style="color: rgb(63, 127, 95)">  * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="702"></span><span style="color: rgb(63, 127, 95)">  * Fails if applied to the empty list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="703"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="704"></span><span style="color: rgb(63, 127, 95)">  * @inc init</span><span style="color: rgb(63, 127, 95)"></code>
<code id="705"></span><span style="color: rgb(63, 127, 95)">  * @inc empty init</span><span style="color: rgb(63, 127, 95)"></code>
<code id="706"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="707"></span><span style="color: rgb(63, 127, 95)">  * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="708"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="709"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">init</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="710"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-last</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="711"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="712"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="713"></span><span style="color: rgb(63, 127, 95)">   * @inc split-init-last</span><span style="color: rgb(63, 127, 95)"></code>
<code id="714"></span><span style="color: rgb(63, 127, 95)">   * @note Alias for split-init-last.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="715"></span><span style="color: rgb(63, 127, 95)">   */ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="716"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-last</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="717"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">split-init-last</span><span style="color: rgb(63, 127, 95)"></code>
<code id="718"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="719"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="720"></span><span style="color: rgb(63, 127, 95)">   * Makes n copies of a term into a list of duplicates. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="721"></span><span style="color: rgb(63, 127, 95)">   * first input term is the integer n, the second is the term</span><span style="color: rgb(63, 127, 95)"></code>
<code id="722"></span><span style="color: rgb(63, 127, 95)">   * to duplicate.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="723"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="724"></span><span style="color: rgb(63, 127, 95)">   * @inc copy-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="725"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="726"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;copy&gt; (3, &quot;foo&quot;) =&gt; [&quot;foo&quot;, &quot;foo&quot;, &quot;foo&quot;]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="727"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="728"></span><span style="color: rgb(63, 127, 95)">   * @type Int * a -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="729"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="730"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">copy</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="731"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">for</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="732"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="733"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">geq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="734"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="735"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="736"></span><span style="color: rgb(63, 127, 95)">   * Makes n copies of a term into a list of duplicates, applying</span><span style="color: rgb(63, 127, 95)"></code>
<code id="737"></span><span style="color: rgb(63, 127, 95)">   * the strategy s to every copy. The first input term is the </span><span style="color: rgb(63, 127, 95)"></code>
<code id="738"></span><span style="color: rgb(63, 127, 95)">   * integer n, the second is the term to duplicate.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="739"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="740"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;copy(\ &quot;foo&quot; -&gt; &quot;bar&quot; \)&gt; (3, &quot;foo&quot;) =&gt; [&quot;bar&quot;,&quot;bar,&quot;bar&quot;]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="741"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="742"></span><span style="color: rgb(63, 127, 95)">   * @param s       a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="743"></span><span style="color: rgb(63, 127, 95)">   * @type    Int * a -&gt; List(n)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="744"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="745"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">copy</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="746"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">for</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="747"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="748"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">ts</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">geq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="749"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="750"></span><span style="color: rgb(63, 127, 95)">  /** @internal */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="751"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">thread-map</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="752"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="753"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="754"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="755"></span><span style="color: rgb(63, 127, 95)">   * Applies s to each element in the list, keeping along a separate</span><span style="color: rgb(63, 127, 95)"></code>
<code id="756"></span><span style="color: rgb(63, 127, 95)">   * context term. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="757"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="758"></span><span style="color: rgb(63, 127, 95)">   * For each element in the list, a tuple (a, b) is constructed and</span><span style="color: rgb(63, 127, 95)"></code>
<code id="759"></span><span style="color: rgb(63, 127, 95)">   * given to s. From the result, (a', b'), a' goes to the final list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="760"></span><span style="color: rgb(63, 127, 95)">   * returned by this strategy, and b' becomes the new b as s is</span><span style="color: rgb(63, 127, 95)"></code>
<code id="761"></span><span style="color: rgb(63, 127, 95)">   * applied to the next element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="762"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="763"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;thread-map(add ; !(&lt;id&gt;, &lt;id&gt;))&gt; ([1,2,3,4], 1) =&gt; ([2,4,7,11],11)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="764"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="765"></span><span style="color: rgb(63, 127, 95)">   * @param s a * b -&gt; a' * b'</span><span style="color: rgb(63, 127, 95)"></code>
<code id="766"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) * b -&gt; List(a') * b'</span><span style="color: rgb(63, 127, 95)"></code>
<code id="767"></span><span style="color: rgb(63, 127, 95)">   */ </span><span style="color: rgb(63, 127, 95)"></code>
<code id="768"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">thread-map</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="769"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t''</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="770"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="771"></span><span style="color: rgb(63, 127, 95)">	</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">thread-map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t''</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="772"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="773"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="774"></span><span style="color: rgb(63, 127, 95)">   * Numbers each element in a list successively with an</span><span style="color: rgb(63, 127, 95)"></code>
<code id="775"></span><span style="color: rgb(63, 127, 95)">   * integer, starting at 0. The result is a list of pairs,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="776"></span><span style="color: rgb(63, 127, 95)">   * (elem, num) where elem is the original element and num</span><span style="color: rgb(63, 127, 95)"></code>
<code id="777"></span><span style="color: rgb(63, 127, 95)">   * is its associated number. s is applied to each pair</span><span style="color: rgb(63, 127, 95)"></code>
<code id="778"></span><span style="color: rgb(63, 127, 95)">   * before inserting it into the list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="779"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="780"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;number(id)&gt; [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;] =&gt; [(&quot;a&quot;,0),(&quot;b&quot;,1),(&quot;c&quot;,2)]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="781"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="782"></span><span style="color: rgb(63, 127, 95)">   * @inc number-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="783"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="784"></span><span style="color: rgb(63, 127, 95)">   * @param s a * Int -&gt; a' * Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="785"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List((a,n),...)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="786"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="787"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">number</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="788"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">thread-map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Snd</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 64, 128)">inc</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="789"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="790"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="791"></span><span style="color: rgb(63, 127, 95)">   * Take elements from the start of a list while s succeeds.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="792"></span><span style="color: rgb(63, 127, 95)">   * Each element of the list is tested against s, starting at</span><span style="color: rgb(63, 127, 95)"></code>
<code id="793"></span><span style="color: rgb(63, 127, 95)">   * the head of the list. For as long as s succeeds, the elements</span><span style="color: rgb(63, 127, 95)"></code>
<code id="794"></span><span style="color: rgb(63, 127, 95)">   * are accumulated in a list, which is returned as s fails, or</span><span style="color: rgb(63, 127, 95)"></code>
<code id="795"></span><span style="color: rgb(63, 127, 95)">   * the end of the list is reached. The actual term returned by</span><span style="color: rgb(63, 127, 95)"></code>
<code id="796"></span><span style="color: rgb(63, 127, 95)">   * s is ignored.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="797"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="798"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;take-while(?2 ; !3)&gt; [2,2,3] =&gt; [2,2]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="799"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="800"></span><span style="color: rgb(63, 127, 95)">   * @param s       a -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="801"></span><span style="color: rgb(63, 127, 95)">   * @type    List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="802"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="803"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">take-while</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="804"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="805"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="806"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="807"></span><span style="color: rgb(63, 127, 95)">   * Take elements from the start of a list until s succeeds. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="808"></span><span style="color: rgb(63, 127, 95)">   * Each element of the list is tested against s, starting at</span><span style="color: rgb(63, 127, 95)"></code>
<code id="809"></span><span style="color: rgb(63, 127, 95)">   * the head of the list. For as long as s does not succeed, the </span><span style="color: rgb(63, 127, 95)"></code>
<code id="810"></span><span style="color: rgb(63, 127, 95)">   * elements are accumulated in a list, which is returned at</span><span style="color: rgb(63, 127, 95)"></code>
<code id="811"></span><span style="color: rgb(63, 127, 95)">   * the instant s fails. The actual term returned by s is</span><span style="color: rgb(63, 127, 95)"></code>
<code id="812"></span><span style="color: rgb(63, 127, 95)">   * ignored. If s never succeeds, the entire list is returned.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="813"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="814"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;take-until(?2; !3)&gt; [3,3,2,4] =&gt; [3,3]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="815"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="816"></span><span style="color: rgb(63, 127, 95)">   * @param s       a -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="817"></span><span style="color: rgb(63, 127, 95)">   * @type    List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="818"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="819"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">take-until</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="820"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="821"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="822"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="823"></span><span style="color: rgb(63, 127, 95)">   * Take the first n elements of a list, given by isn. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="824"></span><span style="color: rgb(63, 127, 95)">   * strategy argument isn must produce an integer, which</span><span style="color: rgb(63, 127, 95)"></code>
<code id="825"></span><span style="color: rgb(63, 127, 95)">   * gives the length of the sublist to return. If there are</span><span style="color: rgb(63, 127, 95)"></code>
<code id="826"></span><span style="color: rgb(63, 127, 95)">   * not enough elements, this strategy fails.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="827"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="828"></span><span style="color: rgb(63, 127, 95)">   * @param isn _ -&gt; Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="829"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="830"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="831"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">take</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">isn</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="832"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">take</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">isn</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="833"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="834"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="835"></span><span style="color: rgb(63, 127, 95)">   * Returns the first n elements of a list, fails</span><span style="color: rgb(63, 127, 95)"></code>
<code id="836"></span><span style="color: rgb(63, 127, 95)">   * if list has fewer than n elements.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="837"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="838"></span><span style="color: rgb(63, 127, 95)">   * @param n The number of elements to take.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="839"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="840"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="841"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">take</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="842"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="843"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="844"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="845"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">take</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="846"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="847"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="848"></span><span style="color: rgb(63, 127, 95)">  /** </span><span style="color: rgb(63, 127, 95)"></code>
<code id="849"></span><span style="color: rgb(63, 127, 95)">   * Returns the n first elements after s has been applied to them.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="850"></span><span style="color: rgb(63, 127, 95)">   * With the exception of side effects, takemap(s|n) is equal to</span><span style="color: rgb(63, 127, 95)"></code>
<code id="851"></span><span style="color: rgb(63, 127, 95)">   * take(|n); map(s). The difference when considering side-effects</span><span style="color: rgb(63, 127, 95)"></code>
<code id="852"></span><span style="color: rgb(63, 127, 95)">   * is that s is applied while taking elements, so if s has a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="853"></span><span style="color: rgb(63, 127, 95)">   * side-effect these will be performed, even if take fails.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="854"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="855"></span><span style="color: rgb(63, 127, 95)">   * @param n - The number of elements to retrieve</span><span style="color: rgb(63, 127, 95)"></code>
<code id="856"></span><span style="color: rgb(63, 127, 95)">   * @param s a -&gt; b </span><span style="color: rgb(63, 127, 95)"></code>
<code id="857"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(b)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="858"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="859"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">takemap</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="860"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="861"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="862"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="863"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">takemap</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="864"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="865"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="866"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="867"></span><span style="color: rgb(63, 127, 95)">   * Drops elements from the start of a list while s succeeds. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="868"></span><span style="color: rgb(63, 127, 95)">   * first element at which s fails and all following it will be</span><span style="color: rgb(63, 127, 95)"></code>
<code id="869"></span><span style="color: rgb(63, 127, 95)">   * returned.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="870"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="871"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;drop-while(?2)&gt; [2,2,3,4] =&gt; [3,4]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="872"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="873"></span><span style="color: rgb(63, 127, 95)">   * @param s       a -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="874"></span><span style="color: rgb(63, 127, 95)">   * @type    List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="875"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="876"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">drop-while</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="877"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="878"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="879"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="880"></span><span style="color: rgb(63, 127, 95)">   * Drops elements from the start of a list until s succeeds. The</span><span style="color: rgb(63, 127, 95)"></code>
<code id="881"></span><span style="color: rgb(63, 127, 95)">   * first element at which s succeeds and all following it will be</span><span style="color: rgb(63, 127, 95)"></code>
<code id="882"></span><span style="color: rgb(63, 127, 95)">   * returned.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="883"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="884"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;drop-until(?3)&gt; [2,2,3,4] =&gt; [3,4]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="885"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="886"></span><span style="color: rgb(63, 127, 95)">   * @param s       a -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="887"></span><span style="color: rgb(63, 127, 95)">   * @type    List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="888"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="889"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">drop-until</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="890"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-suffix</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="891"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="892"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="893"></span><span style="color: rgb(63, 127, 95)">   * Drops the first n elements from a list. If the list has</span><span style="color: rgb(63, 127, 95)"></code>
<code id="894"></span><span style="color: rgb(63, 127, 95)">   * fewer than n elements, the strategy fails.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="895"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="896"></span><span style="color: rgb(63, 127, 95)">   * @param n - the number of elements to drop</span><span style="color: rgb(63, 127, 95)"></code>
<code id="897"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="898"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="899"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">drop</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="900"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="901"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="902"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="903"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">drop</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="904"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="905"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="906"></span><span style="color: rgb(63, 127, 95)">  /** </span><span style="color: rgb(63, 127, 95)"></code>
<code id="907"></span><span style="color: rgb(63, 127, 95)">   * Splits a list after n elements and applies strategy s to the</span><span style="color: rgb(63, 127, 95)"></code>
<code id="908"></span><span style="color: rgb(63, 127, 95)">   * first sublist. The second sublist is left untouched. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="909"></span><span style="color: rgb(63, 127, 95)">   * Disregarding side-effects, splitmap is equal to </span><span style="color: rgb(63, 127, 95)"></code>
<code id="910"></span><span style="color: rgb(63, 127, 95)">   * !(&lt;take(|n); map(s)&gt;, &lt;drop(|n)&gt;). If side-effects are</span><span style="color: rgb(63, 127, 95)"></code>
<code id="911"></span><span style="color: rgb(63, 127, 95)">   * considered, note that application of s happens while</span><span style="color: rgb(63, 127, 95)"></code>
<code id="912"></span><span style="color: rgb(63, 127, 95)">   * traversing and splitting.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="913"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="914"></span><span style="color: rgb(63, 127, 95)">   * @param s a -&gt; b</span><span style="color: rgb(63, 127, 95)"></code>
<code id="915"></span><span style="color: rgb(63, 127, 95)">   * @param n - the number of elements to apply s to, from the start</span><span style="color: rgb(63, 127, 95)"></code>
<code id="916"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; (List(b), List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="917"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="918"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">splitmap</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="919"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="920"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="921"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="922"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="923"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">splitmap</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">subt</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="924"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="925"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="926"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="927"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="928"></span><span style="color: rgb(63, 127, 95)">   * @inc split-fetch</span><span style="color: rgb(63, 127, 95)"></code>
<code id="929"></span><span style="color: rgb(63, 127, 95)">   * @note Alias for split-fetch/1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="930"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="931"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-at</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="932"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">split-fetch</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="933"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="934"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="935"></span><span style="color: rgb(63, 127, 95)">   * Splits a list in two, with the second part containing the last</span><span style="color: rgb(63, 127, 95)"></code>
<code id="936"></span><span style="color: rgb(63, 127, 95)">   * n elements and and first part containing all elements except the</span><span style="color: rgb(63, 127, 95)"></code>
<code id="937"></span><span style="color: rgb(63, 127, 95)">   * last n.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="938"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="939"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; (List(a), List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="940"></span><span style="color: rgb(63, 127, 95)">   * @param n - the number of elements to split at (counting from the back)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="941"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="942"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">back-split-at</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="943"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">0</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="944"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">m</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="945"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">m</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="946"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lt</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">m</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="947"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="948"></span><span style="color: rgb(63, 127, 95)">                 </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">inc</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">m</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="949"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"></code>
<code id="950"></span><span style="color: rgb(63, 127, 95)">                 </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">l</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">r</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">m</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="951"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="952"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="953"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="954"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="955"></span><span style="color: rgb(63, 127, 95)">   * Drops a number of terms from the front of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="956"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="957"></span><span style="color: rgb(63, 127, 95)">   * The number is specified by the strategy argument, which should</span><span style="color: rgb(63, 127, 95)"></code>
<code id="958"></span><span style="color: rgb(63, 127, 95)">   * produce an integer.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="959"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="960"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="961"></span><span style="color: rgb(63, 127, 95)">   * @param _ -&gt; Int</span><span style="color: rgb(63, 127, 95)"></code>
<code id="962"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="963"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">drop</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">isn</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="964"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">isn</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="965"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">nzip0</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="966"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">drop-until</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="967"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Snd</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="968"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="969"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="970"></span><span style="color: rgb(63, 127, 95)">   * Splits the list in two sublists, containing elements from 0 to</span><span style="color: rgb(63, 127, 95)"></code>
<code id="971"></span><span style="color: rgb(63, 127, 95)">   * n and from n onwards.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="972"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="973"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;split-at(|4)&gt;[1,2,3,4,5,6,7,8,9] =&gt; ([1,2,3,4], [5,6,7,8,9])</span><span style="color: rgb(63, 127, 95)"></code>
<code id="974"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="975"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; (List(a), List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="976"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="977"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split-at</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="978"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">at-index-tail</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">n</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="979"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="980"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="981"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="982"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="983"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="984"></span><span style="color: rgb(63, 127, 95)">   * Trim elements from the end of a list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="985"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="986"></span><span style="color: rgb(63, 127, 95)">   * Removes the longest sublist from the end of a list, for which</span><span style="color: rgb(63, 127, 95)"></code>
<code id="987"></span><span style="color: rgb(63, 127, 95)">   * all elements satisfy the strategy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="988"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="989"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="990"></span><span style="color: rgb(63, 127, 95)">   * @param should succeed for all elements that have to be trimmed.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="991"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="992"></span><span style="color: rgb(63, 127, 95)">   * @inc   trim-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="993"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="994"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">rtrim</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="995"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> // Add dummy element, or at-suffix-rev will fail at empty lists</span><span style="color: rgb(63, 127, 95)"></code>
<code id="996"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">at-suffix-rev</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="997"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)">     // This only succeeds if we're not at list-end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="998"></span><span style="color: rgb(63, 127, 95)">           </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> // and s fails at the head of the current suffix</span><span style="color: rgb(63, 127, 95)"></code>
<code id="999"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> // s failed, no further trimming.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1000"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(63, 127, 95)"> // Strip off dummy head element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1001"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1002"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1003"></span><span style="color: rgb(63, 127, 95)">   * Trim elements from the start of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1004"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1005"></span><span style="color: rgb(63, 127, 95)">   * Removes the longest sublist from the start of a list, for which</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1006"></span><span style="color: rgb(63, 127, 95)">   * all elements satisfy the strategy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1007"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1008"></span><span style="color: rgb(63, 127, 95)">   * @type  List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1009"></span><span style="color: rgb(63, 127, 95)">   * @param should succeed for all elements that have to be trimmed.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1010"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1011"></span><span style="color: rgb(63, 127, 95)">   * @inc   trim-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1012"></span><span style="color: rgb(63, 127, 95)">   * @note Alias for drop-while</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1013"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1014"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">ltrim</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">drop-while</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1015"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1016"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1017"></span><span style="color: rgb(63, 127, 95)">   * Trim elements from both start and end of a list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1018"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1019"></span><span style="color: rgb(63, 127, 95)">   * Removest the longest sublist from both start and end of a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1020"></span><span style="color: rgb(63, 127, 95)">   * list for which all elements satisfy s.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1021"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1022"></span><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1023"></span><span style="color: rgb(63, 127, 95)">   * @param s a -&gt; - </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1024"></span><span style="color: rgb(63, 127, 95)">   * @since 0.9.5</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1025"></span><span style="color: rgb(63, 127, 95)">   * @inc trim-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1026"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1027"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">trim</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">ltrim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">rtrim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1028"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1029"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1030"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1031"></span><span style="color: rgb(63, 127, 95)">  /** </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1032"></span><span style="color: rgb(63, 127, 95)">   * Completely flattens a list and its sublists to a single list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1033"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1034"></span><span style="color: rgb(63, 127, 95)">   * See list-misc-test for examples.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1035"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1036"></span><span style="color: rgb(63, 127, 95)">   * @type List(rec x(a or List(x))) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1037"></span><span style="color: rgb(63, 127, 95)">   * @inc flatten-test</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1038"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1039"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">flatten-list</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1040"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">foldr</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">is-list</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">MkCons</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">is-list</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">flatten-list</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1041"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1042"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1043"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1044"></span><span style="color: rgb(63, 127, 95)">   * Eliminates all elements at the end of the two lists that are equal.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1045"></span><span style="color: rgb(63, 127, 95)">   * Only works correctly on lists of equal length!</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1046"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1047"></span><span style="color: rgb(63, 127, 95)">   * Example: &lt;eliminate-common-suffix&gt;([1,3,4], [1,2,4]) =&gt; ([1,3], [1,2])</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1048"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1049"></span><span style="color: rgb(63, 127, 95)">   * @type (List(a), List(a)) -&gt; (List(a), List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1050"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1051"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">eliminate-common-suffix</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1052"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1053"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eliminate-common-suffix</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1054"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1055"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1056"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1057"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1058"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1059"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1060"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1061"></span><span style="color: rgb(63, 127, 95)">   * Returns the common prefix of two lists.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1062"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1063"></span><span style="color: rgb(63, 127, 95)">   * Examples:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1064"></span><span style="color: rgb(63, 127, 95)">   *  &lt;common-prefix&gt;([1,2,3], [1,2,4,5]) =&gt; [1,2]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1065"></span><span style="color: rgb(63, 127, 95)">   *  &lt;common-prefix&gt;([1,2,3], [2,3,4]) =&gt; []</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1066"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1067"></span><span style="color: rgb(63, 127, 95)">   * @type (List(a), List(a)) -&gt; List(a)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1068"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1069"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">common-prefix</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1070"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1071"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">common-prefix</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1072"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1073"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1074"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1075"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1076"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1077"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1078"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1079"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1080"></span><span style="color: rgb(63, 127, 95)">   * Returns a list of combinations by choosing one element from every </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1081"></span><span style="color: rgb(63, 127, 95)">   * list, in every possible combination.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1082"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1083"></span><span style="color: rgb(63, 127, 95)">   * Examples:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1084"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1085"></span><span style="color: rgb(63, 127, 95)">   *   $ &lt;list-combinations&gt; [[1, 2]]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1086"></span><span style="color: rgb(63, 127, 95)">   *   [[1],[2]]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1087"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1088"></span><span style="color: rgb(63, 127, 95)">   *   $ &lt;list-combinations&gt; [[1, 2], []]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1089"></span><span style="color: rgb(63, 127, 95)">   *   []</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1090"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1091"></span><span style="color: rgb(63, 127, 95)">   *   $ &lt;list-combinations&gt; [[1, 2], [&quot;a&quot;, &quot;b&quot;]]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1092"></span><span style="color: rgb(63, 127, 95)">   *   [[1,&quot;a&quot;],[2,&quot;a&quot;],[1,&quot;b&quot;],[2,&quot;b&quot;]]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1093"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1094"></span><span style="color: rgb(63, 127, 95)">   *   $ &lt;list-combinations&gt; []</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1095"></span><span style="color: rgb(63, 127, 95)">   *   [[]]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1096"></span><span style="color: rgb(63, 127, 95)">   *  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1097"></span><span style="color: rgb(63, 127, 95)">   * @type List(List(a)) -&gt; List(List(a))</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1098"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1099"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">list-combinations</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="1100"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">let</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">step</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1101"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1102"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1103"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1104"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1105"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1106"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">step</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1107"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map-intermediate</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1108"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1109"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1110"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">map-intermediate</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1111"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1112"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1113"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">intermediate</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1114"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">intermediate</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1115"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail'</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:=</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map-intermediate</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1116"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map-xs</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">intermediate</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail'</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1117"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1118"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1119"></span><span style="color: rgb(63, 127, 95)">        /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1120"></span><span style="color: rgb(63, 127, 95)">         * This is just a foldr, but Stratego does not support </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1121"></span><span style="color: rgb(63, 127, 95)">         * specialization of map-xs to an intermediate without </span><span style="color: rgb(63, 127, 95)"></code>
<code id="1122"></span><span style="color: rgb(63, 127, 95)">         * introducing tuples, which means that we cannot</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1123"></span><span style="color: rgb(63, 127, 95)">         * use a generic fold.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1124"></span><span style="color: rgb(63, 127, 95)">         */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1125"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">map-xs</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">intermediate</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1126"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1127"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="1128"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1129"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1130"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map-xs</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">intermediate</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tail</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1131"></span><span style="color: rgb(63, 127, 95)">               </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">intermediate</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1132"></span><span style="color: rgb(63, 127, 95)">             </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1133"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">in</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">step</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="1134"></span><span style="color: rgb(63, 127, 95)">   </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1135"></span></code>
