<code id="0"><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="1"></span><span style="color: rgb(63, 127, 95)"> * This module contains strategies for operating on hashtables.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="2"></span><span style="color: rgb(63, 127, 95)"> *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="3"></span><span style="color: rgb(63, 127, 95)"> * It is important to note that hashtables do not have value semantics;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="4"></span><span style="color: rgb(63, 127, 95)"> * all operations on hashtables will modify the existing hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="5"></span><span style="color: rgb(63, 127, 95)"> * Therefore, when you pass a hashtable to a strategy, it will modify</span><span style="color: rgb(63, 127, 95)"></code>
<code id="6"></span><span style="color: rgb(63, 127, 95)"> * the hashtable by side-effect.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="7"></span><span style="color: rgb(63, 127, 95)"> *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="8"></span><span style="color: rgb(63, 127, 95)"> * Hash tables support constant time storing and retrieving of </span><span style="color: rgb(63, 127, 95)"></code>
<code id="9"></span><span style="color: rgb(63, 127, 95)"> * values associated with keys. This module wraps the hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="10"></span><span style="color: rgb(63, 127, 95)"> * facility provided by the ATerm library.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="11"></span><span style="color: rgb(63, 127, 95)"> *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="12"></span><span style="color: rgb(63, 127, 95)"> * @author Eelco Visser &lt;visser@acm.org&gt;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="13"></span><span style="color: rgb(63, 127, 95)"> * @author Martin Bravenboer &lt;martin.bravenboer@gmail.com&gt;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="14"></span><span style="color: rgb(63, 127, 95)"> * @author Karl Trygve Kalleberg &lt;karltk@strategoxt.org&gt; - some documentation</span><span style="color: rgb(63, 127, 95)"></code>
<code id="15"></span><span style="color: rgb(63, 127, 95)"> *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="16"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="17"></span><span style="color: rgb(127, 0, 85)">module</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">collection/hash-table/common</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="18"></span><span style="color: rgb(127, 0, 85)">imports</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="19"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list</span><span style="color: rgb(0, 0, 128)">/</span><span style="color: rgb(0, 0, 128)">-</span><span style="color: rgb(63, 127, 95)"></code>
<code id="20"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="21"></span><span style="color: rgb(127, 0, 85)">signature</span><span style="color: rgb(63, 127, 95)"></code>
<code id="22"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(127, 0, 85)">constructors</span><span style="color: rgb(63, 127, 95)"></code>
<code id="23"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="24"></span><span style="color: rgb(63, 127, 95)">    /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="25"></span><span style="color: rgb(63, 127, 95)">     * Represents a reference to a hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="26"></span><span style="color: rgb(63, 127, 95)">     */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="27"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ImplDep</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="28"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="29"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="30"></span><span style="color: rgb(63, 127, 95)"> * Hashtable construction and deconstruction</span><span style="color: rgb(63, 127, 95)"></code>
<code id="31"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="32"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="33"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="34"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="35"></span><span style="color: rgb(63, 127, 95)">   * Create a new hashtable with default size and load.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="36"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="37"></span><span style="color: rgb(63, 127, 95)">   * @type _ -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="38"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="39"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">new-hashtable</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="40"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">new-hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 128, 0)">117</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 128, 0)">75</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="41"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="42"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="43"></span><span style="color: rgb(63, 127, 95)">   * Create a new hashtable with specified size and load.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="44"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="45"></span><span style="color: rgb(63, 127, 95)">   * @param initial_size - the initial capacity of the hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="46"></span><span style="color: rgb(63, 127, 95)">   * @param max_load - the load percentage at which the hashtable is expanded</span><span style="color: rgb(63, 127, 95)"></code>
<code id="47"></span><span style="color: rgb(63, 127, 95)">   * @type _ -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="48"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="49"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">new-hashtable</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">initial_size</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">max_load</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="50"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_create&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">initial_size</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">max_load</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="51"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="52"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="53"></span><span style="color: rgb(63, 127, 95)">   * Destroys and deallocates memory consumed by an existing hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="54"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="55"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="56"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="57"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-destroy</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="58"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_destroy&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="59"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="60"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="61"></span><span style="color: rgb(63, 127, 95)">   * Clears the contents of an existing hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="62"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="63"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="64"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="65"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-clear</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="66"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_reset&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="67"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="68"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="69"></span><span style="color: rgb(63, 127, 95)"> * Hashtable operations</span><span style="color: rgb(63, 127, 95)"></code>
<code id="70"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="71"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="72"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="73"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="74"></span><span style="color: rgb(63, 127, 95)">   * Puts a new key, value pair into the hash table. If the key is</span><span style="color: rgb(63, 127, 95)"></code>
<code id="75"></span><span style="color: rgb(63, 127, 95)">   * already bound to a value, the old value will be replaced.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="76"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="77"></span><span style="color: rgb(63, 127, 95)">   * @param key - any term can be used as a key</span><span style="color: rgb(63, 127, 95)"></code>
<code id="78"></span><span style="color: rgb(63, 127, 95)">   * @param value - any term can be used as a value</span><span style="color: rgb(63, 127, 95)"></code>
<code id="79"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="80"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="81"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="82"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_put&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="83"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="84"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="85"></span><span style="color: rgb(63, 127, 95)">   * Gets the value for a key. If the key does not exist, this strategy</span><span style="color: rgb(63, 127, 95)"></code>
<code id="86"></span><span style="color: rgb(63, 127, 95)">   * fails.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="87"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="88"></span><span style="color: rgb(63, 127, 95)">   * @param key</span><span style="color: rgb(63, 127, 95)"></code>
<code id="89"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; V</span><span style="color: rgb(63, 127, 95)"></code>
<code id="90"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="91"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="92"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_get&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="93"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="94"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="95"></span><span style="color: rgb(63, 127, 95)">   * Removes a key (with its associated value) from the hashtable. This</span><span style="color: rgb(63, 127, 95)"></code>
<code id="96"></span><span style="color: rgb(63, 127, 95)">   * strategy will succeed even if the key does not exist.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="97"></span><span style="color: rgb(63, 127, 95)">   * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="98"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="99"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="100"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="101"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_remove&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="102"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(63, 127, 95)"></code>
<code id="103"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="104"></span><span style="color: rgb(63, 127, 95)">   * Get a list containing all keys of a hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="105"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="106"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; List(K)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="107"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="108"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="109"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_hashtable_keys&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="110"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="111"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="112"></span><span style="color: rgb(63, 127, 95)">   * Get a list containing all values of a hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="113"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="114"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; List(V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="115"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="116"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-values</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="117"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(63, 127, 95)"></code>
<code id="118"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(63, 127, 95)"></code>
<code id="119"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="120"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="121"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="122"></span><span style="color: rgb(63, 127, 95)">   * Apply an iterative fold left (starting with first element) over</span><span style="color: rgb(63, 127, 95)"></code>
<code id="123"></span><span style="color: rgb(63, 127, 95)">   * the keys of a hash table; useful for applying an operation to each</span><span style="color: rgb(63, 127, 95)"></code>
<code id="124"></span><span style="color: rgb(63, 127, 95)">   * key without constructing a list of keys.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="125"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="126"></span><span style="color: rgb(63, 127, 95)">   * @param (k, v) * a -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="127"></span><span style="color: rgb(63, 127, 95)">   * @param a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="128"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(k, v) -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="129"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="130"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-fold</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">v</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="131"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="132"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_table_fold&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="133"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="134"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="135"></span><span style="color: rgb(63, 127, 95)">   * Apply an iterative fold left (starting with first element) over</span><span style="color: rgb(63, 127, 95)"></code>
<code id="136"></span><span style="color: rgb(63, 127, 95)">   * the keys of a hash table; useful for applying an operation to each</span><span style="color: rgb(63, 127, 95)"></code>
<code id="137"></span><span style="color: rgb(63, 127, 95)">   * key without constructing a list of keys.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="138"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="139"></span><span style="color: rgb(63, 127, 95)">   * @param k * a -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="140"></span><span style="color: rgb(63, 127, 95)">   * @param a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="141"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(k, v) -&gt; a </span><span style="color: rgb(63, 127, 95)"></code>
<code id="142"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="143"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-fold-keys</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="144"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="145"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_table_keys_fold&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="146"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="147"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="148"></span><span style="color: rgb(63, 127, 95)">   * Apply an iterative fold left (starting with first element) over</span><span style="color: rgb(63, 127, 95)"></code>
<code id="149"></span><span style="color: rgb(63, 127, 95)">   * the values of a hash table; useful for applying an operation to each</span><span style="color: rgb(63, 127, 95)"></code>
<code id="150"></span><span style="color: rgb(63, 127, 95)">   * value without constructing a list of values.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="151"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="152"></span><span style="color: rgb(63, 127, 95)">   * @param v * a -&gt; a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="153"></span><span style="color: rgb(63, 127, 95)">   * @param a</span><span style="color: rgb(63, 127, 95)"></code>
<code id="154"></span><span style="color: rgb(63, 127, 95)">   * @type (v * a -&gt; a) * a * HashTable(k, v) -&gt; a </span><span style="color: rgb(63, 127, 95)"></code>
<code id="155"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="156"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-fold-values</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">v</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="157"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="158"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_table_values_fold&quot;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">t</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="159"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="160"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="161"></span><span style="color: rgb(63, 127, 95)"> * Hashtable bulk operations</span><span style="color: rgb(63, 127, 95)"></code>
<code id="162"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="163"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="164"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="165"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="166"></span><span style="color: rgb(63, 127, 95)">   * Get the contents of a hashtable as a list of key-value tuples.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="167"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="168"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(k,v) -&gt; List((k,v), ...)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="169"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="170"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-getlist</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="171"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(63, 127, 95)"></code>
<code id="172"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">let</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">insert</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">v</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">k</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">v</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="173"></span><span style="color: rgb(63, 127, 95)">       </span><span style="color: rgb(127, 0, 85)">in</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-fold</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">insert</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="174"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="175"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="176"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="177"></span><span style="color: rgb(63, 127, 95)">   * Put a list of key,value tuples into a hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="178"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="179"></span><span style="color: rgb(63, 127, 95)">   * @param kv         List(Tuple(K, V), ...)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="180"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="181"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="182"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-putlist</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">kv*</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="183"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(63, 127, 95)"></code>
<code id="184"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">kv*</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="185"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="186"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-putlist</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">f</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ATerm</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">ATerm</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">kv*</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="187"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(63, 127, 95)"></code>
<code id="188"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">kv*</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="189"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="190"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="191"></span><span style="color: rgb(63, 127, 95)">   * Create a new hashtable and initialize it from a key-value pair list.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="192"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="193"></span><span style="color: rgb(63, 127, 95)">   * @type List(Tuple(K, V), ...) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="194"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="195"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-init</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="196"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">kv*</span><span style="color: rgb(63, 127, 95)"></code>
<code id="197"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">new-hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">length</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 128, 0)">75</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="198"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-putlist</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">kv*</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="199"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="200"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="201"></span><span style="color: rgb(63, 127, 95)">   * Create a new hashtable and copies the entire contents of the current</span><span style="color: rgb(63, 127, 95)"></code>
<code id="202"></span><span style="color: rgb(63, 127, 95)">   * table into the new one.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="203"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="204"></span><span style="color: rgb(63, 127, 95)">   * @type HashTable(K, V) -&gt; HashTable(K,V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="205"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="206"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-copy</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="207"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-getlist</span><span style="color: rgb(63, 127, 95)"></code>
<code id="208"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-init</span><span style="color: rgb(63, 127, 95)"></code>
<code id="209"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="210"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="211"></span><span style="color: rgb(63, 127, 95)"> * Stack operations (when stored values in hashtables are list-based stacks)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="212"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="213"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="214"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="215"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="216"></span><span style="color: rgb(63, 127, 95)">   * Pushes value on top of the stack for key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="217"></span><span style="color: rgb(63, 127, 95)">   * Current term is the hashtable and remains untouched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="218"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="219"></span><span style="color: rgb(63, 127, 95)">   * @param key        t - the key used for lookup</span><span style="color: rgb(63, 127, 95)"></code>
<code id="220"></span><span style="color: rgb(63, 127, 95)">   * @param value      a - the value to insert</span><span style="color: rgb(63, 127, 95)"></code>
<code id="221"></span><span style="color: rgb(63, 127, 95)">   * @type  HashTable(K, V) -&gt; HashTable(K, V)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="222"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="223"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-push</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="224"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="225"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="226"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="227"></span><span style="color: rgb(63, 127, 95)">   * Pushes values on top of the stack for key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="228"></span><span style="color: rgb(63, 127, 95)">   * Current term is the hashtable and remains untouched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="229"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="230"></span><span style="color: rgb(63, 127, 95)">   * @param key        t       - the key used for lookup</span><span style="color: rgb(63, 127, 95)"></code>
<code id="231"></span><span style="color: rgb(63, 127, 95)">   * @param value      List(a) - the values to insert</span><span style="color: rgb(63, 127, 95)"></code>
<code id="232"></span><span style="color: rgb(63, 127, 95)">   * @type  HashTable(K, V) -&gt; HashTable(K, V')</span><span style="color: rgb(63, 127, 95)"></code>
<code id="233"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="234"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-pushlist</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="235"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">conc</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="236"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="237"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="238"></span><span style="color: rgb(63, 127, 95)">   * Pushes union of values and already present values </span><span style="color: rgb(63, 127, 95)"></code>
<code id="239"></span><span style="color: rgb(63, 127, 95)">   * Current term is the hashtable.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="240"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="241"></span><span style="color: rgb(63, 127, 95)">   * @param key        t       - the key used for lookup</span><span style="color: rgb(63, 127, 95)"></code>
<code id="242"></span><span style="color: rgb(63, 127, 95)">   * @param value      List(a) - the values to insert</span><span style="color: rgb(63, 127, 95)"></code>
<code id="243"></span><span style="color: rgb(63, 127, 95)">   * @type  HashTable(K, V) -&gt; HashTable(K, V')</span><span style="color: rgb(63, 127, 95)"></code>
<code id="244"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="245"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-pushunion</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="246"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">union</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="247"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="248"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="249"></span><span style="color: rgb(63, 127, 95)">   * Pops off the top element of the stack for key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="250"></span><span style="color: rgb(63, 127, 95)">   * Current term is the hashtable and remains untouched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="251"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="252"></span><span style="color: rgb(63, 127, 95)">   * @param key        t       - the key used for lookup</span><span style="color: rgb(63, 127, 95)"></code>
<code id="253"></span><span style="color: rgb(63, 127, 95)">   * @type  HashTable(K, (V, ...)) -&gt; V</span><span style="color: rgb(63, 127, 95)"></code>
<code id="254"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="255"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-pop</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="256"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="257"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="258"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="259"></span><span style="color: rgb(63, 127, 95)">   * Gets the top value from the stack for key (the stack remains untouched)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="260"></span><span style="color: rgb(63, 127, 95)">   * Current term is the hashtable, output is the top value.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="261"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="262"></span><span style="color: rgb(63, 127, 95)">   * @param key        t       - the key used for lookup</span><span style="color: rgb(63, 127, 95)"></code>
<code id="263"></span><span style="color: rgb(63, 127, 95)">   * @type  HashTable(K, (V, ...)) -&gt; V</span><span style="color: rgb(63, 127, 95)"></code>
<code id="264"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="265"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-peek</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="266"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(63, 127, 95)"></code>
<code id="267"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="268"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="269"></span><span style="color: rgb(63, 127, 95)">   * Gets the top value from the stack for key and pops it off the stack.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="270"></span><span style="color: rgb(63, 127, 95)">   * Current term is the hashtable, output is the top value.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="271"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="272"></span><span style="color: rgb(63, 127, 95)">   * @param key        t       - the key used for lookup</span><span style="color: rgb(63, 127, 95)"></code>
<code id="273"></span><span style="color: rgb(63, 127, 95)">   * @type  HashTable(K, (V, ...)) -&gt; V</span><span style="color: rgb(63, 127, 95)"></code>
<code id="274"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="275"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-peekpop</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="276"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">hashtable-peek</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="277"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-pop</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="278"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(63, 127, 95)"></code>
<code id="279"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="280"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="281"></span><span style="color: rgb(63, 127, 95)"> * Mnemonic parameter strategies for hashtable-merge.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="282"></span><span style="color: rgb(63, 127, 95)"> */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="283"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="284"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="285"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="286"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">symmetric-yes</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="287"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">symmetric-no</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="288"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">iterate1-yes</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="289"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">iterate1-no</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="290"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="291"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">iterate2-no</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="292"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">remove-yes</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="293"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 64, 128)">     </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="294"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">default-no</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="295"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">change1-yes</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="296"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">change1-no</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="297"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">change2-yes</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(63, 127, 95)"></code>
<code id="298"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">change2-no</span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="299"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="300"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="301"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="302"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="303"></span><span style="color: rgb(63, 127, 95)">   * Merge two hashtables changing one or both.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="304"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="305"></span><span style="color: rgb(63, 127, 95)">   * This a highly generic strategy for merging two hashtables. The algorithm</span><span style="color: rgb(63, 127, 95)"></code>
<code id="306"></span><span style="color: rgb(63, 127, 95)">   * is parameterized with a number of knobs that determine its behaviour.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="307"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="308"></span><span style="color: rgb(63, 127, 95)">   * (A little language for table merging!-)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="309"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="310"></span><span style="color: rgb(63, 127, 95)">   * @param symm     : apply changes to both tables, if not apply to tbl1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="311"></span><span style="color: rgb(63, 127, 95)">   * @param iterate1 : iterate over keys of tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="312"></span><span style="color: rgb(63, 127, 95)">   * @param iterate2 : iterate over keys of tbl2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="313"></span><span style="color: rgb(63, 127, 95)">   * @param remove   : remove table entry if undefined in other table</span><span style="color: rgb(63, 127, 95)"></code>
<code id="314"></span><span style="color: rgb(63, 127, 95)">   * @param merge    : operation on pair of values</span><span style="color: rgb(63, 127, 95)"></code>
<code id="315"></span><span style="color: rgb(63, 127, 95)">   * @param default  : default value in case lookup in other table fails</span><span style="color: rgb(63, 127, 95)"></code>
<code id="316"></span><span style="color: rgb(63, 127, 95)">   * @param lookup1  : given a key produce value for left table</span><span style="color: rgb(63, 127, 95)"></code>
<code id="317"></span><span style="color: rgb(63, 127, 95)">   * @param lookup2  : given a key produce value for right table</span><span style="color: rgb(63, 127, 95)"></code>
<code id="318"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="319"></span><span style="color: rgb(63, 127, 95)">   * @todo : with a proper partial evaluator for Stratego this strategy can be</span><span style="color: rgb(63, 127, 95)"></code>
<code id="320"></span><span style="color: rgb(63, 127, 95)">   *         used to create appropriately specialized algorithms.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="321"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="322"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">symm</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">iterate1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">iterate2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">remove</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">merge</span><span style="color: rgb(63, 127, 95)"></code>
<code id="323"></span><span style="color: rgb(63, 127, 95)">                 </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">default</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">change1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">change2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">lookup1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">lookup2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"></code>
<code id="324"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="325"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="326"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="327"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">filter</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="328"></span><span style="color: rgb(63, 127, 95)">                </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"></code>
<code id="329"></span><span style="color: rgb(63, 127, 95)">                </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lookup2</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="330"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="331"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">merge</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="332"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">ior</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="333"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="334"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="335"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"></code>
<code id="336"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="337"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="338"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="339"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to tbl2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="340"></span><span style="color: rgb(63, 127, 95)">                         </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"></code>
<code id="341"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="342"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="343"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="344"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">default</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="345"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="346"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">merge</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="347"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">ior</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="348"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="349"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="350"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"></code>
<code id="351"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="352"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="353"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="354"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="355"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="356"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="357"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> // lookup2 failed, no default</span><span style="color: rgb(63, 127, 95)"></code>
<code id="358"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="359"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="360"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="361"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="362"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)">                </span><span style="color: rgb(63, 127, 95)"></code>
<code id="363"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="364"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to either table            </span><span style="color: rgb(63, 127, 95)"></code>
<code id="365"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="366"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="367"></span><span style="color: rgb(63, 127, 95)">              </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="368"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">changes1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="369"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="370"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="371"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="372"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="373"></span><span style="color: rgb(63, 127, 95)">            </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">filter</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="374"></span><span style="color: rgb(63, 127, 95)">                </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"></code>
<code id="375"></span><span style="color: rgb(63, 127, 95)">                </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="376"></span><span style="color: rgb(63, 127, 95)">                </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">lookup1</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="377"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="378"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">merge</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="379"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">ior</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="380"></span><span style="color: rgb(63, 127, 95)">                            </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="381"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="382"></span><span style="color: rgb(63, 127, 95)">                            </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="383"></span><span style="color: rgb(63, 127, 95)">                          </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="384"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="385"></span><span style="color: rgb(63, 127, 95)">                           </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to tbl2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="386"></span><span style="color: rgb(63, 127, 95)">                         </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"></code>
<code id="387"></span><span style="color: rgb(63, 127, 95)">                           </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="388"></span><span style="color: rgb(63, 127, 95)">                         </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="389"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="390"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">default</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="391"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="392"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">merge</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">val1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="393"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="394"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">val2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="395"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val3</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="396"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="397"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> // lookup1 failed and no default</span><span style="color: rgb(63, 127, 95)"></code>
<code id="398"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="399"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="400"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">if</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">then</span><span style="color: rgb(63, 127, 95)"></code>
<code id="401"></span><span style="color: rgb(63, 127, 95)">                        </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="402"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(63, 127, 95)"></code>
<code id="403"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="404"></span><span style="color: rgb(63, 127, 95)">                      </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"> // no change to either table            </span><span style="color: rgb(63, 127, 95)"></code>
<code id="405"></span><span style="color: rgb(63, 127, 95)">                    </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="406"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"></code>
<code id="407"></span><span style="color: rgb(63, 127, 95)">              </span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="408"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="409"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(127, 0, 85)">else</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">end</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">changes2</span><span style="color: rgb(63, 127, 95)"></code>
<code id="410"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">changes1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">not</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">changes2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="411"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="412"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="413"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="414"></span><span style="color: rgb(63, 127, 95)">   * Version without change arguments for backward compatibility</span><span style="color: rgb(63, 127, 95)"></code>
<code id="415"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="416"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">symm</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">iterate1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">iterate2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">remove</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">merge</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">default</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="417"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(0, 0, 0)">lookup1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">lookup2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="418"></span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">symm</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">merge</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">default</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="419"></span><span style="color: rgb(63, 127, 95)">                  </span><span style="color: rgb(0, 64, 128)">change1-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">change2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="420"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="421"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="422"></span><span style="color: rgb(63, 127, 95)">   * Merge hashtables creating a new one.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="423"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="424"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-merge-func</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">iterate1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">iterate2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">remove</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">merge</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">default</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">lookup1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">lookup2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="425"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="426"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-copy</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl3</span><span style="color: rgb(63, 127, 95)"></code>
<code id="427"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">symmetric-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">iterate2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">remove</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">merge</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">default</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl3</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="428"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="429"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"> // intersection merges</span><span style="color: rgb(63, 127, 95)"></code>
<code id="430"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="431"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="432"></span><span style="color: rgb(63, 127, 95)">   * Intersect hashtables.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="433"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="434"></span><span style="color: rgb(63, 127, 95)">   * Changes tbl1; fails if no changes are made</span><span style="color: rgb(63, 127, 95)"></code>
<code id="435"></span><span style="color: rgb(63, 127, 95)">   * Assumes that both hashtables contains lists as values, and intersects</span><span style="color: rgb(63, 127, 95)"></code>
<code id="436"></span><span style="color: rgb(63, 127, 95)">   * the two listvalues for each key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="437"></span><span style="color: rgb(63, 127, 95)">   * This is a 'pure' intersection: only keys that appear in both tables</span><span style="color: rgb(63, 127, 95)"></code>
<code id="438"></span><span style="color: rgb(63, 127, 95)">   * remain in the input table, rest is removed.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="439"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="440"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-intersect</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="441"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="442"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="443"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="444"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="445"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="446"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="447"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(63, 127, 95)"></code>
<code id="448"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">isect</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="449"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">default-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="450"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="451"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="452"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="453"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="454"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="455"></span><span style="color: rgb(63, 127, 95)">   * Intersect hashtables with default element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="456"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="457"></span><span style="color: rgb(63, 127, 95)">   * Changes tbl1; fails if no changes are made</span><span style="color: rgb(63, 127, 95)"></code>
<code id="458"></span><span style="color: rgb(63, 127, 95)">   * Assumes that both hashtables contains lists as values, and intersects</span><span style="color: rgb(63, 127, 95)"></code>
<code id="459"></span><span style="color: rgb(63, 127, 95)">   * the two listvalues for each key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="460"></span><span style="color: rgb(63, 127, 95)">   * Places a dummy value if key does not exist in one of the tables.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="461"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="462"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-intersect-wempty</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="463"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="464"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="465"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="466"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="467"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="468"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="469"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(63, 127, 95)"></code>
<code id="470"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">isect</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="471"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="472"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="473"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="474"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="475"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="476"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="477"></span><span style="color: rgb(63, 127, 95)">   * Intersect hashtables symmetrically with default element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="478"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="479"></span><span style="color: rgb(63, 127, 95)">   * Changes tbl1 and tbl2; fails if no changes are made in tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="480"></span><span style="color: rgb(63, 127, 95)">   * Assumes that both hashtables contains lists as values, and intersects</span><span style="color: rgb(63, 127, 95)"></code>
<code id="481"></span><span style="color: rgb(63, 127, 95)">   * the two listvalues for each key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="482"></span><span style="color: rgb(63, 127, 95)">   * Places a dummy value if key does not exist in one of the tables.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="483"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="484"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="485"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-intersect-symm-wempty</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="486"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="487"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="488"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="489"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="490"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="491"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="492"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">isect</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="493"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="494"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="495"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="496"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="497"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="498"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="499"></span><span style="color: rgb(63, 127, 95)">   * Intersect hashtables symmetrically with default element.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="500"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="501"></span><span style="color: rgb(63, 127, 95)">   * Changes tbl1 and tbl2; fails if no changes are made in tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="502"></span><span style="color: rgb(63, 127, 95)">   * Assumes that both hashtables contains lists as values, and intersects</span><span style="color: rgb(63, 127, 95)"></code>
<code id="503"></span><span style="color: rgb(63, 127, 95)">   * the two listvalues for each key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="504"></span><span style="color: rgb(63, 127, 95)">   * Places a dummy value if key does not exist in one of the tables.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="505"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="506"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="507"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-intersect-symm-wempty-ignore-left</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="508"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="509"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="510"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="511"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="512"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="513"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="514"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">isect</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="515"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="516"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">change1-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="517"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">change2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="518"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="519"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="520"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="521"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="522"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"> // union merges</span><span style="color: rgb(63, 127, 95)"></code>
<code id="523"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="524"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="525"></span><span style="color: rgb(63, 127, 95)">   * Union of hashtables</span><span style="color: rgb(63, 127, 95)"></code>
<code id="526"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="527"></span><span style="color: rgb(63, 127, 95)">   * Changes tbl1; fails if no changes are made</span><span style="color: rgb(63, 127, 95)"></code>
<code id="528"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="529"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="530"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-union</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="531"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="532"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="533"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="534"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="535"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="536"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="537"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(63, 127, 95)"></code>
<code id="538"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">union</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="539"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="540"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="541"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="542"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="543"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="544"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-union-wempty</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="545"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"></code>
<code id="546"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="547"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="548"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="549"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="550"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="551"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(63, 127, 95)"></code>
<code id="552"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">union</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="553"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="554"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="555"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(127, 0, 85)">fail</span><span style="color: rgb(63, 127, 95)"></code>
<code id="556"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="557"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="558"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-union-symm-wempty</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="559"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="560"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-merge</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="561"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">symmetric-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="562"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate1-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="563"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">iterate2-yes</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="564"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">remove-no</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(63, 127, 95)"></code>
<code id="565"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 64, 128)">union</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="566"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">emptyElt</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="567"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="568"></span><span style="color: rgb(63, 127, 95)">        </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"></code>
<code id="569"></span><span style="color: rgb(63, 127, 95)">     </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="570"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="571"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="572"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="573"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="574"></span><span style="color: rgb(63, 127, 95)">   * Checks whether two hashtables have equal contents.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="575"></span><span style="color: rgb(63, 127, 95)">   * This strategy uses the basic `eq` to compare the elements.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="576"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="577"></span><span style="color: rgb(63, 127, 95)">   * @type Tuple(HashTable(K, V), HashTable(K,V)) -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="578"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="579"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-eq</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="580"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">hashtable-eq</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="581"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="582"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="583"></span><span style="color: rgb(63, 127, 95)">   * Checks whether two tables have the same keys, and for each key whether</span><span style="color: rgb(63, 127, 95)"></code>
<code id="584"></span><span style="color: rgb(63, 127, 95)">   * the associated values are the same (order of keys thus doesn't matter)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="585"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="586"></span><span style="color: rgb(63, 127, 95)">   * @param test strategy that will compare two elements upon their equality.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="587"></span><span style="color: rgb(63, 127, 95)">   * @inc hashtable-eq</span><span style="color: rgb(63, 127, 95)"></code>
<code id="588"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="589"></span><span style="color: rgb(63, 127, 95)">   * @type Tuple(HashTable(K, V), HashTable(K,V)) -&gt; _</span><span style="color: rgb(63, 127, 95)"></code>
<code id="590"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="591"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-eq</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">eq</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="592"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">k*</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">set-eq</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="593"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">eq</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">tbl2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">k*</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="594"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="595"></span><span style="color: rgb(63, 127, 95)">/**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="596"></span><span style="color: rgb(63, 127, 95)"> * Legacy table strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="597"></span><span style="color: rgb(63, 127, 95)"> */</code>
<code id="598"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="599"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="600"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="601"></span><span style="color: rgb(63, 127, 95)">   * Retrieves the primitive table-table as a Hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="602"></span><span style="color: rgb(63, 127, 95)">   *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="603"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="604"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-hashtable</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="605"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">prim</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">&quot;SSL_table_hashtable&quot;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">Hashtable</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="606"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="607"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="608"></span><span style="color: rgb(63, 127, 95)">   * Retrieves a named table by looking it up in the table-table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="609"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="610"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 64, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="611"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">table-hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="612"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="613"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-create</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="614"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="615"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="616"></span><span style="color: rgb(63, 127, 95)">  * Creates a table with a given name, which can be any term.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="617"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="618"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-create</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="619"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(63, 127, 95)"></code>
<code id="620"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">new-hashtable</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="621"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">table-hashtable</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="622"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="623"></span><span style="color: rgb(63, 127, 95)">  /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="624"></span><span style="color: rgb(63, 127, 95)">   * Destroy a table with a given name, which can be any term.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="625"></span><span style="color: rgb(63, 127, 95)">   */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="626"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-destroy</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="627"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(63, 127, 95)"></code>
<code id="628"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">table-hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="629"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="630"></span><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-destroy</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="631"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="632"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="633"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="634"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="635"></span><span style="color: rgb(63, 127, 95)">  * Associate a value with a key in a table. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="636"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="637"></span><span style="color: rgb(63, 127, 95)">  * E.g. &lt;table-put&gt; (t1, key, value) associates value with key in the t1 table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="638"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="639"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="640"></span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="641"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="642"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="643"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="644"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="645"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="646"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="647"></span><span style="color: rgb(63, 127, 95)">  * Get the value associated with a key from a table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="648"></span><span style="color: rgb(63, 127, 95)">  * </span><span style="color: rgb(63, 127, 95)"></code>
<code id="649"></span><span style="color: rgb(63, 127, 95)">  * E.g. &lt;table-get&gt; (t1, key) yields the value associated to key or fails in the t1 table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="650"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="651"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="652"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="653"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="654"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-get</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="655"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="656"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="657"></span><span style="color: rgb(63, 127, 95)">  * Remove association of a key in a table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="658"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="659"></span><span style="color: rgb(63, 127, 95)">  * E.g. &lt;table-remove&gt; (t1, key) removes the entry for key from table t1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="660"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="661"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-remove</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="662"></span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="663"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="664"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="665"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="666"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="667"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="668"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="669"></span><span style="color: rgb(63, 127, 95)">  * Produce a list of keys of a table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="670"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="671"></span><span style="color: rgb(63, 127, 95)">  * E.g. &lt;table-keys&gt;t1 produces the list of keys of table t1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="672"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="673"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-keys</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="674"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(63, 127, 95)"></code>
<code id="675"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="676"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-keys</span><span style="color: rgb(63, 127, 95)"></code>
<code id="677"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="678"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="679"></span><span style="color: rgb(63, 127, 95)">  * Renames a table, i.e. only the entry in the table-table is renamed,</span><span style="color: rgb(63, 127, 95)"></code>
<code id="680"></span><span style="color: rgb(63, 127, 95)">  * the table contents remain untouched.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="681"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="682"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-rename</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"></code>
<code id="683"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">from-name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">to-name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="684"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">lookup-table</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">from-name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="685"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">table-hashtable</span><span style="color: rgb(63, 127, 95)"></code>
<code id="686"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-put</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">to-name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">htbl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="687"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">hashtable-remove</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">from-name</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="688"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">to-name</span><span style="color: rgb(63, 127, 95)"></code>
<code id="689"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="690"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="691"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="692"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="693"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="694"></span><span style="color: rgb(63, 127, 95)">  * Get a list of key-value pairs.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="695"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="696"></span><span style="color: rgb(63, 127, 95)">  * E.g. &lt;table-getlist&gt;t1 produces the list of (key,value) pairs in the table t1. </span><span style="color: rgb(63, 127, 95)"></code>
<code id="697"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="698"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-getlist</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="699"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 64, 128)">table-keys</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">\</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="700"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="701"></span><span style="color: rgb(63, 127, 95)"> /**</span><span style="color: rgb(63, 127, 95)"></code>
<code id="702"></span><span style="color: rgb(63, 127, 95)">  * Put a list of key-value pairs in a table.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="703"></span><span style="color: rgb(63, 127, 95)">  *</span><span style="color: rgb(63, 127, 95)"></code>
<code id="704"></span><span style="color: rgb(63, 127, 95)">  * E.g. &lt;table-putlist&gt;(name, list) puts the (key,value) pairs in list into table t1.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="705"></span><span style="color: rgb(63, 127, 95)">  */</span><span style="color: rgb(63, 127, 95)"></code>
<code id="706"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-putlist</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">list</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="707"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="708"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="709"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-putlist</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">list</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="710"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">{</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">}</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">list</span><span style="color: rgb(63, 127, 95)"></code>
<code id="711"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="712"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-copy</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">name2</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="713"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-putlist</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">name2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-getlist</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">name1</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="714"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="715"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="716"></span><span style="color: rgb(63, 127, 95)">/*</span><span style="color: rgb(63, 127, 95)"></code>
<code id="717"></span><span style="color: rgb(63, 127, 95)">        Symbol tables that deal with scoped bindings need to be able</span><span style="color: rgb(63, 127, 95)"></code>
<code id="718"></span><span style="color: rgb(63, 127, 95)">        to store multiple bindings for the same symbol. The following</span><span style="color: rgb(63, 127, 95)"></code>
<code id="719"></span><span style="color: rgb(63, 127, 95)">        table operations can be used to maintain a stack (list)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="720"></span><span style="color: rgb(63, 127, 95)">        of values for each key.</span><span style="color: rgb(63, 127, 95)"></code>
<code id="721"></span><span style="color: rgb(63, 127, 95)">*/</span><span style="color: rgb(63, 127, 95)"></code>
<code id="722"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="723"></span><span style="color: rgb(127, 0, 85)">strategies</span><span style="color: rgb(63, 127, 95)"></code>
<code id="724"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="725"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-push</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="726"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="727"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="728"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-pop</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="729"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="730"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="731"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-pop-rm</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="732"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"></code>
<code id="733"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="734"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="735"></span><span style="color: rgb(63, 127, 95)">      </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-remove</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="736"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="737"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="738"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-pop-get</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="739"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">vals</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="740"></span><span style="color: rgb(63, 127, 95)">         </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">vals</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="741"></span><span style="color: rgb(63, 127, 95)">         </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(63, 127, 95)"></code>
<code id="742"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="743"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-lookup</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="744"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(63, 127, 95)"></code>
<code id="745"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="746"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-replace</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="747"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">=&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">values</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"></code>
<code id="748"></span><span style="color: rgb(63, 127, 95)">         </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">dis</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">value</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">values</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="749"></span><span style="color: rgb(63, 127, 95)">         </span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="750"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="751"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-union</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="752"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">union</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="753"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="754"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-diff</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="755"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">diff</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="756"></span><span style="color: rgb(63, 127, 95)"></code>
<code id="757"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">table-append</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"></code>
<code id="758"></span><span style="color: rgb(63, 127, 95)">    </span><span style="color: rgb(127, 0, 85)">where</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-put</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">union</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">table-get</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 64, 128)">&gt;</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">table</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">key</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">val</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"></code>
<code id="759"></span></code>
